<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MemoLearning — Calculus I</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ---------- GLOBAL VARIABLES ---------- */
        :root {
            --indigo: #6366f1;
            --indigo-light: #818cf8;
            --indigo-dark: #4f46e5;
            --purple: #7c3aed;
            --purple-light: #8b5cf6;
            --purple-dark: #6d28d9;
            --slate: #0f172a;
            --slate-light: #334155;
            --muted: #475569;
            --muted-light: #94a3b8;
            --card: #ffffff;
            --card-alt: #f8fafc;
            --success: #10b981;
            --success-light: #d1fae5;
            --warning: #f59e0b;
            --warning-light: #fef3c7;
            --danger: #ef4444;
            --danger-light: #fee2e2;
            --info: #3b82f6;
            --info-light: #dbeafe;
            --radius-sm: 6px;
            --radius: 12px;
            --radius-lg: 18px;
            --radius-xl: 24px;
            --shadow-sm: 0 4px 6px rgba(0,0,0,0.05);
            --shadow: 0 10px 25px rgba(0,0,0,0.1);
            --shadow-lg: 0 20px 40px rgba(0,0,0,0.15);
            --transition: all 0.3s ease;
        }

        /* ---------- GLOBAL STYLES ---------- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            height: 100%;
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
            color: var(--slate);
            background: linear-gradient(135deg, #667eea 0%, #7c3aed 100%) fixed;
            line-height: 1.6;
        }

        /* ---------- TYPOGRAPHY ---------- */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 0.5em;
        }

        /* ---------- BUTTONS ---------- */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            background: var(--indigo);
            color: #fff;
            border: none;
            padding: 10px 18px;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }

        .btn:hover {
            background: var(--indigo-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn.secondary {
            background: var(--slate);
        }

        .btn.secondary:hover {
            background: #1e293b;
        }

        .btn.outline {
            background: transparent;
            border: 2px solid var(--indigo);
            color: var(--indigo);
        }

        .btn.outline:hover {
            background: var(--indigo);
            color: white;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn i {
            font-size: 0.9em;
        }

        /* ---------- OVERVIEW PAGE ---------- */
        .overview-page {
            display: block;
            min-height: 100vh;
        }

        .overview-page.hidden {
            display: none;
        }

        .overview-header {
            background: rgba(255, 255, 255, 0.10);
            backdrop-filter: blur(20px);
            color: #fff;
            padding: 60px 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.25);
        }

        .overview-header h1 {
            margin: 0;
            font-weight: 800;
            font-size: 48px;
            text-shadow: 0 2px 20px rgba(0, 0, 0, 0.35);
            letter-spacing: -0.5px;
        }

        .overview-header p {
            margin: 16px 0 0;
            font-size: 20px;
            opacity: 0.95;
            font-weight: 300;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .curriculum-stats {
            background: rgba(255, 255, 255, 0.10);
            backdrop-filter: blur(18px);
            border-radius: var(--radius-xl);
            padding: 32px;
            color: #fff;
            margin-bottom: 32px;
            box-shadow: var(--shadow);
        }

        .curriculum-stats h2 {
            margin: 0 0 20px 0;
            font-size: 28px;
            font-weight: 700;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 24px;
        }

        .stat-item {
            text-align: center;
            padding: 16px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-lg);
            transition: var(--transition);
        }

        .stat-item:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-3px);
        }

        .stat-number {
            font-size: 42px;
            font-weight: 800;
            display: block;
            margin-bottom: 4px;
            background: linear-gradient(135deg, #fff, #e0e7ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            opacity: 0.9;
            font-size: 16px;
        }

        .units-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 28px;
        }

        .unit-card {
            position: relative;
            background: rgba(255, 255, 255, 0.98);
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: var(--radius-xl);
            padding: 28px;
            box-shadow: var(--shadow);
            cursor: pointer;
            overflow: hidden;
            transition: var(--transition);
        }

        .unit-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--indigo), var(--purple));
        }

        .unit-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
        }

        .unit-header {
            display: flex;
            align-items: center;
            margin-bottom: 14px;
        }

        .unit-number {
            width: 42px;
            height: 42px;
            border-radius: 999px;
            background: linear-gradient(135deg, var(--indigo), var(--purple));
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
            margin-right: 16px;
            flex-shrink: 0;
        }

        .unit-title {
            margin: 0;
            font-weight: 700;
            font-size: 22px;
            color: var(--slate);
        }

        .unit-description {
            color: var(--muted);
            margin: 8px 0 16px;
            font-size: 15px;
        }

        .topics-list {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .topics-list li {
            position: relative;
            padding: 10px 0 10px 24px;
            border-bottom: 1px solid #f1f5f9;
            color: var(--slate-light);
            transition: var(--transition);
        }

        .topics-list li:hover {
            background: #f8fafc;
            padding-left: 28px;
        }

        .topics-list li:last-child {
            border-bottom: none;
        }

        .topics-list li::before {
            content: '▸';
            position: absolute;
            left: 8px;
            color: var(--indigo);
            font-weight: 700;
        }

        .optional-badge {
            background: linear-gradient(135deg, var(--warning), #d97706);
            color: #fff;
            font-size: 12px;
            font-weight: 700;
            border-radius: 999px;
            padding: 4px 10px;
            margin-left: 10px;
            box-shadow: var(--shadow-sm);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(22px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .unit-card {
            opacity: 0;
            animation: fadeInUp 0.6s ease forwards;
        }

        /* ---------- UNIT PAGE ---------- */
        .unit-page {
            display: none;
            min-height: 100vh;
        }

        .unit-page.active {
            display: block;
        }

        .unit-header-stick {
            position: sticky;
            top: 0;
            z-index: 50;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: saturate(1.15) blur(8px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            color: var(--slate);
            padding: 16px 20px;
            box-shadow: var(--shadow-sm);
        }

        .unit-header-stick .wrap {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            gap: 16px;
            align-items: center;
        }

        .unit-header-stick h1 {
            margin: 0;
            font-size: 24px;
            font-weight: 700;
            color: var(--slate);
        }

        .unit-header-stick .sub {
            color: var(--muted);
            font-size: 15px;
        }

        .unit-header-stick .btn {
            margin-left: auto;
            background: var(--indigo);
            border: 1px solid var(--indigo-dark);
            color: #fff;
            border-radius: 999px;
            padding: 8px 16px;
            cursor: pointer;
        }

        .unit-header-stick .btn:hover {
            background: var(--indigo-dark);
        }

        .app {
            max-width: 1200px;
            margin: 24px auto;
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 24px;
            padding: 0 20px;
        }

        aside {
            background: #fff;
            border: 1px solid #e5e7eb;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow);
            overflow: hidden;
            align-self: start;
            position: sticky;
            top: 90px;
            max-height: calc(100vh - 120px);
            display: flex;
            flex-direction: column;
        }

        .side-head {
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.12), rgba(124, 58, 237, 0.12));
        }

        .side-head h2 {
            margin: 0 0 12px 0;
            font-size: 18px;
            color: var(--slate);
        }

        .lesson-list {
            list-style: none;
            margin: 0;
            padding: 0;
            overflow: auto;
            flex-grow: 1;
        }

        .lesson-list li {
            border-bottom: 1px solid #eef2ff;
        }

        .lesson {
            display: flex;
            gap: 12px;
            padding: 14px 16px;
            text-decoration: none;
            color: inherit;
            cursor: pointer;
            align-items: center;
            transition: var(--transition);
        }

        .lesson:hover {
            background: #f8fafc;
        }

        .lesson.active {
            background: #eef2ff;
            border-left: 4px solid var(--indigo);
        }

        .tag {
            font-size: 11px;
            color: var(--indigo);
            font-weight: 700;
            background: #eef2ff;
            border-radius: 999px;
            padding: 4px 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .done {
            margin-left: auto;
            font-size: 12px;
            color: var(--success);
            font-weight: 700;
            display: none;
        }

        .lesson.completed .done {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        main {
            min-height: 70vh;
        }

        .card {
            background: #fff;
            border: 1px solid #e5e7eb;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow);
            padding: 28px;
            margin-bottom: 24px;
        }

        .crumbs {
            color: var(--muted);
            font-size: 13px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .crumbs span:not(:last-child)::after {
            content: '/';
            margin: 0 8px;
            color: var(--muted-light);
        }

        .title {
            margin: 4px 0 8px;
            font-size: 28px;
            font-weight: 800;
            color: var(--slate);
            line-height: 1.2;
        }

        .lead {
            color: var(--muted);
            margin: 0 0 16px;
            font-size: 17px;
            line-height: 1.5;
        }

        .content-block {
            margin-bottom: 20px;
        }

        .content-block p {
            margin-bottom: 16px;
            line-height: 1.7;
        }

        .example {
            border: 1px solid #c7d2fe;
            background: #eef2ff;
            padding: 18px 20px;
            border-radius: var(--radius);
            margin: 16px 0;
            position: relative;
        }

        .example h4 {
            margin: 0 0 8px;
            color: var(--indigo-dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .example h4 i {
            font-size: 18px;
            flex-shrink: 0;
        }

        .note {
            border-left: 4px solid var(--success);
            background: var(--success-light);
            padding: 16px 20px;
            border-radius: var(--radius);
            margin: 16px 0;
            display: flex;
            gap: 12px;
        }

        .note::before {
            content: '💡';
            font-size: 18px;
            flex-shrink: 0;
        }

        .warn {
            border-left: 4px solid var(--warning);
            background: var(--warning-light);
            padding: 16px 20px;
            border-radius: var(--radius);
            margin: 16px 0;
            display: flex;
            gap: 12px;
        }

        .warn::before {
            content: '⚠️';
            font-size: 18px;
            flex-shrink: 0;
        }

        .practice, .quiz {
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px dashed #e5e7eb;
        }

        .problem, .q {
            border: 1px solid #e5e7eb;
            border-radius: var(--radius-lg);
            background: var(--card-alt);
            padding: 20px;
            margin: 16px 0;
        }

        .problem h5, .q h5 {
            margin: 0 0 12px;
            font-size: 18px;
            color: var(--slate);
        }

        .choice {
            display: flex;
            gap: 12px;
            align-items: center;
            border: 1px solid #e5e7eb;
            border-radius: var(--radius);
            padding: 12px;
            margin: 8px 0;
            cursor: pointer;
            transition: var(--transition);
        }

        .choice:hover {
            background: #f1f5f9;
            border-color: var(--indigo-light);
        }

        .choice input[type="radio"] {
            accent-color: var(--indigo);
        }

        .input {
            padding: 12px 14px;
            border: 1px solid #cbd5e1;
            border-radius: var(--radius);
            width: 100%;
            max-width: 300px;
            font-family: inherit;
            font-size: 15px;
            transition: var(--transition);
        }

        .input:focus {
            outline: none;
            border-color: var(--indigo);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        .ok {
            color: #065f46;
            background: var(--success-light);
            border: 1px solid var(--success);
            padding: 12px 16px;
            border-radius: var(--radius);
            margin-top: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .bad {
            color: #991b1b;
            background: var(--danger-light);
            border: 1px solid var(--danger);
            padding: 12px 16px;
            border-radius: var(--radius);
            margin-top: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .help {
            color: var(--info);
            text-decoration: underline;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            margin-top: 12px;
            font-weight: 500;
        }

        .solution {
            display: none;
            padding: 16px;
            border: 1px dashed #93c5fd;
            background: var(--info-light);
            color: #1e3a8a;
            border-radius: var(--radius);
            margin-top: 12px;
            white-space: pre-line;
            line-height: 1.6;
        }

        .footer-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid #e5e7eb;
        }

        .progress {
            height: 10px;
            border-radius: 999px;
            background: #eef2ff;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress>span {
            display: block;
            height: 100%;
            background: linear-gradient(90deg, var(--indigo), var(--purple));
            width: 0%;
            border-radius: 999px;
            transition: width 0.5s ease;
        }

        .progress-text {
            font-size: 13px;
            color: var(--muted);
            text-align: right;
        }

        /* Math styling */
        .math {
            font-family: 'Times New Roman', serif;
            font-style: italic;
        }

        .equation {
            background: #f8fafc;
            padding: 12px 16px;
            border-radius: var(--radius);
            margin: 12px 0;
            overflow-x: auto;
        }

        /* Quiz results */
        .quiz-results {
            margin-top: 20px;
            padding: 20px;
            background: #f8fafc;
            border-radius: var(--radius);
            text-align: center;
        }

        .score-display {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 16px;
            color: var(--indigo-dark);
        }

        .correct-answer {
            color: var(--success);
        }

        .incorrect-answer {
            color: var(--danger);
        }

        /* Responsive adjustments */
        @media (max-width: 1024px) {
            .app {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            aside {
                position: static;
                max-height: none;
            }
            
            .unit-header-stick .wrap {
                flex-wrap: wrap;
            }
            
            .units-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .overview-header {
                padding: 40px 20px;
            }
            
            .overview-header h1 {
                font-size: 36px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .footer-nav {
                flex-direction: column;
                align-items: stretch;
            }
            
            .footer-nav .btn {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .unit-card {
                padding: 20px;
            }
            
            .card {
                padding: 20px;
            }
        }

        /* Animation for correct/incorrect answers */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }

        .correct-pulse {
            animation: pulse 0.5s ease;
        }

        /* Code block styling */
        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 16px;
            border-radius: var(--radius);
            margin: 16px 0;
            overflow-x: auto;
            font-family: 'Fira Code', monospace;
            font-size: 14px;
        }

        /* Highlight box */
        .highlight {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(124, 58, 237, 0.1));
            border-left: 4px solid var(--indigo);
            padding: 20px;
            border-radius: var(--radius);
            margin: 20px 0;
        }

        .highlight h4 {
            margin-top: 0;
            color: var(--indigo-dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Definition box */
        .definition {
            background: #f0f9ff;
            border-left: 4px solid var(--info);
            padding: 20px;
            border-radius: var(--radius);
            margin: 20px 0;
        }

        .definition h4 {
            margin-top: 0;
            color: var(--info);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Key takeaways */
        .key-takeaways {
            background: #ecfdf5;
            border: 1px solid #a7f3d0;
            border-radius: var(--radius);
            padding: 20px;
            margin: 20px 0;
        }

        .key-takeaways h4 {
            margin-top: 0;
            color: var(--success);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .key-takeaways ul {
            padding-left: 20px;
            margin-bottom: 0;
        }

        .key-takeaways li {
            margin-bottom: 8px;
        }

        .key-takeaways li:last-child {
            margin-bottom: 0;
        }

        /* Video container */
        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
            margin: 20px 0;
            border-radius: var(--radius);
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Step-by-step guidance */
        .step-by-step {
            background: #f8fafc;
            border-left: 4px solid var(--purple);
            padding: 20px;
            border-radius: var(--radius);
            margin: 20px 0;
        }

        .step-by-step h4 {
            margin-top: 0;
            color: var(--purple-dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .step {
            margin-bottom: 16px;
            display: flex;
            gap: 12px;
        }

        .step-number {
            background: var(--purple);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-weight: 600;
            font-size: 14px;
        }

        .step-content {
            flex: 1;
        }

        .step:last-child {
            margin-bottom: 0;
        }

        /* Real-world connection */
        .real-world {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 20px;
            border-radius: var(--radius);
            margin: 20px 0;
        }

        .real-world h4 {
            margin-top: 0;
            color: #b45309;
            display: flex;
            align-items: center;
            gap: 8px;
        }
    </style>
</head>
<body>

<!-- ================= OVERVIEW ================= -->
<div class="overview-page" id="overviewPage">
    <header class="overview-header">
        <h1><i class="fas fa-graduation-cap"></i> MemoLearning Calculus I</h1>
        <p>Master calculus with our comprehensive curriculum featuring interactive lessons, practice problems, and quizzes</p>
    </header>

    <div class="container">
        <div class="curriculum-stats">
            <h2>Curriculum Overview</h2>
            <div class="stats-grid">
                <div class="stat-item"><span class="stat-number">8</span><div class="stat-label">Total Units</div></div>
                <div class="stat-item"><span class="stat-number">~140</span><div class="stat-label">Skills to Master</div></div>
                <div class="stat-item"><span class="stat-number">6</span><div class="stat-label">Core Units</div></div>
                <div class="stat-item"><span class="stat-number">2</span><div class="stat-label">Application Units</div></div>
            </div>
        </div>

        <div class="units-grid">
            <!-- Unit 1: Limits and Continuity -->
            <div class="unit-card" style="animation-delay:0s" onclick="openUnit(1)">
                <div class="unit-header"><div class="unit-number">1</div><h3 class="unit-title">Limits and Continuity</h3></div>
                <p class="unit-description">Foundation of calculus: understanding limits, continuity, and the behavior of functions.</p>
                <ul class="topics-list">
                    <li>Limit definition and intuitive understanding</li>
                    <li>Evaluating limits algebraically and graphically</li>
                    <li>One-sided limits and infinite limits</li>
                    <li>Continuity at a point and on intervals</li>
                    <li>Intermediate Value Theorem</li>
                    <li>Limits at infinity and horizontal asymptotes</li>
                    <li>Squeeze Theorem</li>
                </ul>
            </div>

            <!-- Unit 2: Derivatives -->
            <div class="unit-card" style="animation-delay:.05s" onclick="openUnit(2)">
                <div class="unit-header"><div class="unit-number">2</div><h3 class="unit-title">Derivatives</h3></div>
                <p class="unit-description">Core concept: rates of change, tangent lines, and the derivative as a limit.</p>
                <ul class="topics-list">
                    <li>Definition of derivative as a limit</li>
                    <li>Geometric interpretation: tangent lines</li>
                    <li>Differentiability vs. continuity</li>
                    <li>Basic differentiation rules</li>
                    <li>Power rule, constant rule, sum rule</li>
                    <li>Derivatives of polynomial functions</li>
                    <li>Higher-order derivatives</li>
                </ul>
            </div>

            <!-- Unit 3: Differentiation Rules -->
            <div class="unit-card" style="animation-delay:.10s" onclick="openUnit(3)">
                <div class="unit-header"><div class="unit-number">3</div><h3 class="unit-title">Differentiation Rules</h3></div>
                <p class="unit-description">Master all the techniques for finding derivatives of complex functions.</p>
                <ul class="topics-list">
                    <li>Product rule and quotient rule</li>
                    <li>Chain rule and composite functions</li>
                    <li>Derivatives of trigonometric functions</li>
                    <li>Derivatives of exponential functions</li>
                    <li>Derivatives of logarithmic functions</li>
                    <li>Derivatives of inverse trig functions</li>
                    <li>Implicit differentiation</li>
                    <li>Related rates problems</li>
                </ul>
            </div>

            <!-- Unit 4: Applications of Derivatives -->
            <div class="unit-card" style="animation-delay:.15s" onclick="openUnit(4)">
                <div class="unit-header"><div class="unit-number">4</div><h3 class="unit-title">Applications of Derivatives</h3></div>
                <p class="unit-description">Use derivatives to analyze functions and solve optimization problems.</p>
                <ul class="topics-list">
                    <li>Critical points and local extrema</li>
                    <li>First and second derivative tests</li>
                    <li>Concavity and inflection points</li>
                    <li>Curve sketching and function analysis</li>
                    <li>Optimization problems</li>
                    <li>Mean Value Theorem</li>
                    <li>L'Hôpital's Rule</li>
                    <li>Linear approximation and differentials</li>
                </ul>
            </div>

            <!-- Unit 5: Integrals -->
            <div class="unit-card" style="animation-delay:.20s" onclick="openUnit(5)">
                <div class="unit-header"><div class="unit-number">5</div><h3 class="unit-title">Integrals</h3></div>
                <p class="unit-description">Introduce antiderivatives and the Fundamental Theorem of Calculus.</p>
                <ul class="topics-list">
                    <li>Antiderivatives and indefinite integrals</li>
                    <li>Basic integration rules</li>
                    <li>Riemann sums and definite integrals</li>
                    <li>Fundamental Theorem of Calculus</li>
                    <li>Properties of definite integrals</li>
                    <li>Net change theorem</li>
                    <li>Average value of a function</li>
                </ul>
            </div>

            <!-- Unit 6: Integration Techniques -->
            <div class="unit-card" style="animation-delay:.25s" onclick="openUnit(6)">
                <div class="unit-header"><div class="unit-number">6</div><h3 class="unit-title">Integration Techniques</h3></div>
                <p class="unit-description">Advanced methods for evaluating integrals and antiderivatives.</p>
                <ul class="topics-list">
                    <li>Integration by substitution (u-substitution)</li>
                    <li>Integration by parts</li>
                    <li>Trigonometric integrals</li>
                    <li>Trigonometric substitution</li>
                    <li>Partial fractions</li>
                    <li>Improper integrals</li>
                    <li>Numerical integration methods</li>
                </ul>
            </div>

            <!-- Unit 7: Applications of Integration -->
            <div class="unit-card" style="animation-delay:.30s" onclick="openUnit(7)">
                <div class="unit-header"><div class="unit-number">7</div><h3 class="unit-title">Applications of Integration</h3></div>
                <p class="unit-description">Use integration to find areas, volumes, and solve real-world problems.</p>
                <ul class="topics-list">
                    <li>Area between curves</li>
                    <li>Volumes using disk and washer methods</li>
                    <li>Volumes using cylindrical shells</li>
                    <li>Arc length and surface area</li>
                    <li>Work and fluid pressure</li>
                    <li>Center of mass and moments</li>
                    <li>Differential equations and slope fields</li>
                </ul>
            </div>

            <!-- Unit 8: Differential Equations -->
            <div class="unit-card" style="animation-delay:.35s" onclick="openUnit(8)">
                <div class="unit-header"><div class="unit-number">8</div><h3 class="unit-title">Differential Equations</h3></div>
                <p class="unit-description">Introduction to solving basic differential equations and modeling real-world phenomena.</p>
                <ul class="topics-list">
                    <li>Slope fields and Euler's method</li>
                    <li>Separable differential equations</li>
                    <li>Exponential growth and decay models</li>
                    <li>Logistic growth models</li>
                    <li>Newton's law of cooling</li>
                    <li>Related rates applications</li>
                    <li>Modeling with differential equations</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- ================= GENERIC UNIT PAGE ================= -->
<div class="unit-page" id="unitPage">
    <header class="unit-header-stick">
        <div class="wrap">
            <h1><i class="fas fa-book"></i> MemoLearning — Calculus I</h1>
            <div class="sub" id="unitSub">Unit • …</div>
            <button class="btn" onclick="backToOverview()"><i class="fas fa-arrow-left"></i> Back to Overview</button>
        </div>
    </header>

    <div class="app">
        <aside>
            <div class="side-head">
                <h2 id="sideTitle">Lessons</h2>
                <div class="progress" title="Progress"><span id="progressbar"></span></div>
                <div class="progress-text" id="progressText">0% Complete</div>
            </div>
            <ul class="lesson-list" id="lessonList"></ul>
        </aside>

        <main>
            <div class="card" id="article">
                <div class="crumbs" id="crumbs">
                    <span>Unit</span>
                    <span>Section</span>
                    <span>Page</span>
                </div>
                <h2 class="title" id="title">Title</h2>
                <p class="lead" id="lead">Lead sentence.</p>
                <div id="content"></div>
                <div class="practice" id="practice"></div>
                <div class="quiz" id="quiz"></div>
                <div class="footer-nav">
                    <button class="btn secondary" id="prevBtn"><i class="fas fa-arrow-left"></i> Previous</button>
                    <div style="flex:1"></div>
                    <button class="btn" id="nextBtn">Up next <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
        </main>
    </div>
</div>

<script>
/* =================== DATA: CALCULUS I UNITS =================== */
const UNITS = {
    1: { 
        id:'u1', title:'Limits and Continuity',
        sections:[
            { id:'limit-definition', title:'Limit Definition',
                pages:[
                    { id:'theory', label:'Theory', tag:'Article', blocks:[
                        {type:'p', text:'Limits are the foundation of calculus. They describe the behavior of a function as its input approaches a certain value, even if the function is not defined at that point.'},
                        {type:'definition', title:'Limit', text:'The limit of f(x) as x approaches a is L, written as lim┬(x→a) f(x) = L, if we can make f(x) arbitrarily close to L by taking x sufficiently close to a (but not equal to a).'},
                        {type:'p', text:'This concept allows us to analyze functions at points where they might not be defined, or where they behave in interesting ways.'},
                        {type:'step-by-step', title:'Understanding Limits Step-by-Step', text:[
                            'Identify the function and the point you\'re approaching',
                            'Examine the behavior from both left and right sides',
                            'Check if the function approaches the same value from both sides',
                            'If both sides agree, the limit exists at that point'
                        ]},
                        {type:'ex', title:'Simple Limit Example', text:'Consider f(x) = (x² - 1)/(x - 1). Even though f(1) is undefined, we can simplify: (x² - 1)/(x - 1) = x + 1 for x ≠ 1. Therefore, lim┬(x→1) f(x) = 2.'},
                        {type:'note', text:'The limit depends only on values near a, not at a itself. This is why we can find limits even when functions are undefined at specific points.'},
                        {type:'warn', text:'A common mistake is to assume that if f(a) is defined, then lim┬(x→a) f(x) = f(a). While this is true for continuous functions, it\'s not always the case.'},
                        {type:'real-world', title:'Real-World Application', text:'Limits model many real-world situations. For example, if you approach a traffic light, your speed approaches 0 as you get closer to the light, regardless of whether you actually stop exactly at the line.'}
                    ]},
                    { id:'evaluating', label:'Evaluating Limits', tag:'Article', blocks:[
                        {type:'p', text:'There are several techniques for evaluating limits, depending on the form of the function and the point being approached.'},
                        {type:'p', text:'The first approach should always be direct substitution. If this results in a determinate value, you\'ve found the limit. If it results in an indeterminate form like 0/0, you\'ll need other techniques.'},
                        {type:'highlight', title:'Techniques for Evaluating Limits', text:'1. Direct substitution<br>2. Factoring and canceling<br>3. Rationalizing<br>4. Using special limits (like lim┬(x→0) sin(x)/x = 1)<br>5. The Squeeze Theorem'},
                        {type:'ex', title:'Factoring Example', text:'Evaluate lim┬(x→2) (x² - 4)/(x - 2)<br>Direct substitution gives 0/0 (indeterminate)<br>Factor: (x² - 4) = (x - 2)(x + 2)<br>Cancel: (x - 2)(x + 2)/(x - 2) = x + 2 for x ≠ 2<br>Now evaluate: lim┬(x→2) (x + 2) = 4'},
                        {type:'key-takeaways', title:'Key Takeaways', text:[
                            'Always try direct substitution first',
                            'If you get 0/0, try factoring, rationalizing, or other algebraic techniques',
                            'The limit may exist even when the function is undefined at that point',
                            'Practice identifying which technique to use in different situations'
                        ]}
                    ]},
                    { id:'practice', label:'Practice', tag:'Practice', blocks:[
                        {type:'p', text:'Practice evaluating limits with these problems. Try different techniques and check your answers.'},
                        {type:'step-by-step', title:'Evaluation Steps', text:[
                            'Try direct substitution',
                            'If indeterminate, try algebraic manipulation',
                            'Factor, rationalize, or simplify as needed',
                            'Try substitution again with the simplified form',
                            'Verify your answer makes sense'
                        ]}
                    ],
                        practice:[
                            {id:'u1_p1', kind:'numeric', prompt:'lim┬(x→3) (x² - 9)/(x - 3)', ans:6, tol:1e-3, sol:'Factor: (x² - 9) = (x - 3)(x + 3)<br>Cancel: (x - 3)(x + 3)/(x - 3) = x + 3 for x ≠ 3<br>Evaluate: lim┬(x→3) (x + 3) = 6'},
                            {id:'u1_p2', kind:'numeric', prompt:'lim┬(x→0) (√(x + 4) - 2)/x', ans:0.25, tol:1e-3, sol:'Rationalize the numerator:<br>Multiply by (√(x + 4) + 2)/(√(x + 4) + 2)<br>= (x + 4 - 4)/(x(√(x + 4) + 2)) = 1/(√(x + 4) + 2)<br>Evaluate: lim┬(x→0) 1/(√(x + 4) + 2) = 1/4 = 0.25'},
                            {id:'u1_p3', kind:'mc', prompt:'lim┬(x→0) sin(x)/x =', options:['0','1','Undefined','∞'], correct:1, sol:'This is a standard limit. As x approaches 0, sin(x)/x approaches 1.'}
                        ]
                    },
                    { id:'quiz', label:'Quiz', tag:'Quiz', quiz:[
                        {id:'u1_q1', q:'If lim┬(x→a) f(x) exists, then:', opts:['f(a) must be defined','f(a) may not be defined','f must be continuous at x = a'], a:1, exp:'The limit depends on values near a, not at a. f(a) may be undefined or different from the limit.'},
                        {id:'u1_q2', q:'lim┬(x→2) (3x² - 5x + 2) =', opts:['4','6','8','10'], a:0, exp:'Direct substitution: 3(2)² - 5(2) + 2 = 12 - 10 + 2 = 4.'},
                        {id:'u1_q3', q:'If f(x) = { x² for x < 1; 2x for x ≥ 1 }, then lim┬(x→1) f(x) =', opts:['1','2','Does not exist','0'], a:1, exp:'Left-hand limit: lim┬(x→1⁻) x² = 1<br>Right-hand limit: lim┬(x→1⁺) 2x = 2<br>Since these are not equal, the limit does not exist.'},
                        {id:'u1_q4', q:'The Squeeze Theorem states that if f(x) ≤ g(x) ≤ h(x) near a and:', opts:['lim┬(x→a) f(x) = lim┬(x→a) h(x) = L, then lim┬(x→a) g(x) = L','lim┬(x→a) f(x) = lim┬(x→a) h(x) = ∞','g(x) is continuous at a'], a:0, exp:'If f and h have the same limit L at a, and g is squeezed between them, then g must also approach L.'},
                        {id:'u1_q5', q:'lim┬(x→∞) (3x² + 2x - 5)/(2x² - x + 7) =', opts:['0','1','1.5','∞'], a:2, exp:'For rational functions as x→∞, divide numerator and denominator by the highest power of x: (3 + 2/x - 5/x²)/(2 - 1/x + 7/x²) → 3/2 = 1.5'}
                    ]}
                ]},
            { id:'continuity', title:'Continuity',
                pages:[
                    { id:'theory', label:'Theory', tag:'Article', blocks:[
                        {type:'p', text:'Continuity is a fundamental property of functions that describes whether they have any breaks, jumps, or holes. Intuitively, a function is continuous if you can draw its graph without lifting your pencil.'},
                        {type:'definition', title:'Continuity at a Point', text:'A function f is continuous at x = a if: 1) f(a) is defined, 2) lim┬(x→a) f(x) exists, and 3) lim┬(x→a) f(x) = f(a).'},
                        {type:'p', text:'If any of these three conditions fails, the function is discontinuous at that point. Discontinuities can be removable (holes), jump discontinuities, or infinite discontinuities.'},
                        {type:'step-by-step', title:'Checking Continuity', text:[
                            'Check if f(a) is defined',
                            'Check if lim┬(x→a) f(x) exists',
                            'Check if the limit equals f(a)',
                            'If all three conditions are met, the function is continuous at a'
                        ]},
                        {type:'ex', title:'Continuity Example', text:'f(x) = x² is continuous at x = 2 because: 1) f(2) = 4 is defined, 2) lim┬(x→2) x² = 4 exists, and 3) lim┬(x→2) x² = 4 = f(2).'},
                        {type:'ex', title:'Discontinuity Example', text:'f(x) = 1/x is discontinuous at x = 0 because f(0) is undefined. This is an infinite discontinuity.'},
                        {type:'note', text:'Polynomials, rational functions (where defined), trigonometric functions (where defined), exponential functions, and logarithmic functions are all continuous on their domains.'},
                        {type:'real-world', title:'Real-World Application', text:'Continuity is important in physics and engineering. For example, the position of a moving object should be a continuous function of time (objects don\'t teleport). Discontinuities might indicate impacts or other sudden changes.'}
                    ]},
                    { id:'practice', label:'Practice', tag:'Practice', blocks:[
                        {type:'p', text:'Practice identifying points of continuity and discontinuity with these problems.'},
                        {type:'highlight', title:'Types of Discontinuity', text:'Removable: Hole in the graph (limit exists but f(a) is undefined or wrong)<br>Jump: Left and right limits exist but are different<br>Infinite: Function approaches ±∞<br>Oscillating: Function oscillates infinitely (like sin(1/x) at 0)'}
                    ],
                        practice:[
                            {id:'u1_c1', kind:'mc', prompt:'Where is f(x) = (x² - 4)/(x - 2) discontinuous?', options:['x = 2','x = -2','x = 0','Nowhere'], correct:0, sol:'The function has a removable discontinuity at x = 2. It can be simplified to x + 2 for x ≠ 2, but is undefined at x = 2.'},
                            {id:'u1_c2', kind:'mc', prompt:'Which function is continuous everywhere?', options:['f(x) = 1/x','f(x) = √x','f(x) = x³','f(x) = tan(x)'], correct:2, sol:'f(x) = x³ is a polynomial, and all polynomials are continuous everywhere. The others have restrictions on their domains.'},
                            {id:'u1_c3', kind:'mc', prompt:'The function f(x) = { x² for x < 1; 3 for x = 1; 2x for x > 1 } has what type of discontinuity at x = 1?', options:['Removable','Jump','Infinite','None'], correct:1, sol:'Left-hand limit: lim┬(x→1⁻) x² = 1<br>Right-hand limit: lim┬(x→1⁺) 2x = 2<br>Since these are different, this is a jump discontinuity.'}
                        ]
                    }
                ]}
        ]
    },

    /* === Unit 2: Derivatives === */
    2:{id:'u2', title:'Derivatives', sections:[
        {id:'derivative-definition', title:'Definition of Derivative', pages:[
            {id:'theory', label:'Theory', tag:'Article', blocks:[
                {type:'p', text:'The derivative is a fundamental concept in calculus that measures how a function changes as its input changes. It represents the instantaneous rate of change or the slope of the tangent line at a point.'},
                {type:'definition', title:'Derivative', text:'The derivative of a function f at a point x = a is defined as: f\'(a) = lim┬(h→0) [f(a + h) - f(a)]/h, provided this limit exists.'},
                {type:'p', text:'This is called the limit definition of the derivative. The difference quotient [f(a + h) - f(a)]/h represents the average rate of change over the interval [a, a + h]. As h approaches 0, this becomes the instantaneous rate of change.'},
                {type:'step-by-step', title:'Finding a Derivative Using the Limit Definition', text:[
                    'Write out the difference quotient: [f(a + h) - f(a)]/h',
                    'Simplify the numerator algebraically',
                    'Cancel h from the denominator if possible',
                    'Take the limit as h approaches 0',
                    'The result is f\'(a)'
                ]},
                {type:'ex', title:'Derivative Example', text:'Find the derivative of f(x) = x² at x = 3 using the limit definition.<br>f\'(3) = lim┬(h→0) [(3 + h)² - 3²]/h<br>= lim┬(h→0) [9 + 6h + h² - 9]/h<br>= lim┬(h→0) (6h + h²)/h<br>= lim┬(h→0) (6 + h) = 6'},
                {type:'note', text:'The derivative f\'(a) represents the slope of the tangent line to the graph of f at the point (a, f(a)). It also represents the instantaneous rate of change of f with respect to x at x = a.'},
                {type:'real-world', title:'Real-World Application', text:'Derivatives have countless applications: velocity is the derivative of position, acceleration is the derivative of velocity, marginal cost in economics is the derivative of the cost function, and many more.'}
            ]},
            {id:'practice', label:'Practice', tag:'Practice', blocks:[
                {type:'p', text:'Practice finding derivatives using the limit definition with these problems.'},
                {type:'highlight', title:'Helpful Tips', text:'1. Expand and simplify the numerator before taking the limit<br>2. Look for opportunities to cancel h from the denominator<br>3. Remember that the derivative is a limit, so use limit laws<br>4. Practice with polynomial functions first, as they are simplest'}
            ],
                practice:[
                    {id:'u2_p1', kind:'numeric', prompt:'Using the limit definition, find the derivative of f(x) = 3x + 2 at x = 4.', ans:3, tol:1e-3, sol:'f\'(4) = lim┬(h→0) [3(4 + h) + 2 - (3×4 + 2)]/h<br>= lim┬(h→0) [12 + 3h + 2 - 14]/h<br>= lim┬(h→0) (3h)/h = lim┬(h→0) 3 = 3'},
                    {id:'u2_p2', kind:'numeric', prompt:'Using the limit definition, find the derivative of f(x) = x² - x at x = 2.', ans:3, tol:1e-3, sol:'f\'(2) = lim┬(h→0) [((2 + h)² - (2 + h)) - (4 - 2)]/h<br>= lim┬(h→0) [(4 + 4h + h² - 2 - h) - 2]/h<br>= lim┬(h→0) (3h + h²)/h = lim┬(h→0) (3 + h) = 3'},
                    {id:'u2_p3', kind:'mc', prompt:'What does the derivative f\'(a) represent geometrically?', options:['The slope of the secant line through (a, f(a)) and (a+h, f(a+h))','The slope of the tangent line at (a, f(a))','The average rate of change on [a, a+h]','The y-intercept of the tangent line'], correct:1, sol:'The derivative represents the slope of the tangent line at the point (a, f(a)).'}
                ]
            },
            {id:'quiz', label:'Quiz', tag:'Quiz', quiz:[
                {id:'u2_q1', q:'The derivative f\'(a) is defined as:', opts:['[f(a + h) - f(a)]/h','lim┬(h→0) [f(a + h) - f(a)]/h','f(a + h) - f(a)','lim┬(h→∞) [f(a + h) - f(a)]/h'], a:1, exp:'The derivative is the limit of the difference quotient as h approaches 0.'},
                {id:'u2_q2', q:'If f(x) = c (a constant function), then f\'(x) =', opts:['0','1','c','x'], a:0, exp:'The derivative of a constant function is always 0 because the function doesn\'t change.'},
                {id:'u2_q3', q:'If f\'(3) = 5, this means:', opts:['f(3) = 5','The tangent line at x=3 has slope 5','The secant line from x=2 to x=3 has slope 5','f(5) = 3'], a:1, exp:'The derivative at a point gives the slope of the tangent line at that point.'},
                {id:'u2_q4', q:'The difference quotient [f(a + h) - f(a)]/h represents:', opts:['The instantaneous rate of change at x=a','The average rate of change on [a, a+h]','The derivative at x=a','The slope of the tangent line at x=a'], a:1, exp:'The difference quotient gives the average rate of change over the interval [a, a+h]. The derivative is the limit as h→0.'},
                {id:'u2_q5', q:'If a function is not continuous at x=a, then:', opts:['It may still be differentiable at x=a','It cannot be differentiable at x=a','It must be differentiable at x=a','Its derivative is 0 at x=a'], a:1, exp:'Differentiability implies continuity. If a function is not continuous at a point, it cannot be differentiable there.'}
            ]}
        ]}
    ]},

    /* === Unit 3: Differentiation Rules === */
    3: {
        id:'u3', title:'Differentiation Rules',
        sections:[
            {id:'basic-rules', title:'Basic Differentiation Rules', pages:[
                {id:'theory', label:'Theory', tag:'Article', blocks:[
                    {type:'p', text:'While we can use the limit definition to find derivatives, it\'s often more efficient to use differentiation rules. These rules allow us to find derivatives quickly without going through the limit process each time.'},
                    {type:'definition', title:'Power Rule', text:'If f(x) = xⁿ, where n is any real number, then f\'(x) = nxⁿ⁻¹.'},
                    {type:'ex', title:'Power Rule Examples', text:'f(x) = x⁵ → f\'(x) = 5x⁴<br>f(x) = √x = x¹ᐟ² → f\'(x) = (1/2)x⁻¹ᐟ² = 1/(2√x)<br>f(x) = 1/x = x⁻¹ → f\'(x) = -x⁻² = -1/x²'},
                    {type:'definition', title:'Constant Multiple Rule', text:'If f(x) = c·g(x), where c is a constant, then f\'(x) = c·g\'(x).'},
                    {type:'definition', title:'Sum/Difference Rule', text:'If f(x) = g(x) ± h(x), then f\'(x) = g\'(x) ± h\'(x).'},
                    {type:'ex', title:'Combining Rules', text:'f(x) = 3x⁴ + 2x² - 5x + 7<br>f\'(x) = 3(4x³) + 2(2x) - 5(1) + 0 = 12x³ + 4x - 5'},
                    {type:'note', text:'These rules make differentiation much faster than using the limit definition. With practice, you\'ll be able to differentiate polynomials almost instantly.'},
                    {type:'real-world', title:'Real-World Application', text:'These rules are used extensively in physics, engineering, economics, and any field that uses calculus. For example, if position is given by a polynomial function, we can quickly find velocity and acceleration using these rules.'}
                ]},
                {id:'practice', label:'Practice', tag:'Practice', blocks:[
                    {type:'p', text:'Practice using the basic differentiation rules with these problems.'},
                    {type:'step-by-step', title:'Differentiation Steps', text:[
                        'Identify each term in the function',
                        'Apply the constant multiple rule if needed',
                        'Apply the power rule to each term',
                        'Apply the sum/difference rule to combine results',
                        'Simplify your answer'
                    ]}
                ],
                    practice:[
                        {id:'u3_p1', kind:'numeric', prompt:'Find the derivative of f(x) = 4x³ - 2x² + 7x - 5', ans:'12x^2-4x+7', tol:0, sol:'Apply the power rule to each term:<br>f\'(x) = 4(3x²) - 2(2x) + 7(1) - 0 = 12x² - 4x + 7'},
                        {id:'u3_p2', kind:'numeric', prompt:'Find the derivative of f(x) = 3√x + 2/x', ans:'3/(2√x)-2/x^2', tol:0, sol:'Rewrite: f(x) = 3x¹ᐟ² + 2x⁻¹<br>f\'(x) = 3(1/2)x⁻¹ᐟ² + 2(-1)x⁻² = (3/2)/√x - 2/x²'},
                        {id:'u3_p3', kind:'mc', prompt:'What is the derivative of f(x) = π² (where π is the constant)?', options:['0','2π','π²','2π²'], correct:0, sol:'π² is a constant, and the derivative of any constant is 0.'}
                    ]
                },
                {id:'quiz', label:'Quiz', tag:'Quiz', quiz:[
                    {id:'u3_q1', q:'d/dx(xⁿ) =', opts:['nx','nxⁿ⁻¹','xⁿ⁻¹','nxⁿ⁺¹'], a:1, exp:'This is the power rule: the derivative of xⁿ is nxⁿ⁻¹.'},
                    {id:'u3_q2', q:'If f(x) = 5g(x) and g\'(x) = 3, then f\'(x) =', opts:['5','15','3','0'], a:1, exp:'By the constant multiple rule: f\'(x) = 5·g\'(x) = 5·3 = 15.'},
                    {id:'u3_q3', q:'The derivative of a sum is:', opts:['The product of the derivatives','The sum of the derivatives','The quotient of the derivatives','Always zero'], a:1, exp:'The sum rule states that the derivative of a sum is the sum of the derivatives.'},
                    {id:'u3_q4', q:'d/dx(4) =', opts:['0','1','4','x'], a:0, exp:'4 is a constant, and the derivative of any constant is 0.'},
                    {id:'u3_q5', q:'If f(x) = x¹⁰⁰, then f\'(x) =', opts:['100x⁹⁹','100x¹⁰⁰','99x¹⁰⁰','x⁹⁹'], a:0, exp:'Using the power rule: f\'(x) = 100x¹⁰⁰⁻¹ = 100x⁹⁹.'}
                ]}
            ]}
        ]
    },

    /* Additional units would be defined here following the same pattern */
};

/* =================== RENDER ENGINE =================== */
let state = {unitId:null, sIdx:0, pIdx:0};

function $(sel){return document.querySelector(sel)}
function el(tag, cls){const n=document.createElement(tag); if(cls) n.className=cls; return n}
function clear(node){node.innerHTML=''}

// Expose globally so inline onclick="openUnit(n)" works
window.openUnit = function(n){
    const unit = UNITS[n];
    if(!unit){ alert('Unit not found.'); return; }
    state.unitId = n; state.sIdx = 0; state.pIdx = 0;
    $('#overviewPage').classList.add('hidden');
    $('#unitPage').classList.add('active');
    $('#unitSub').textContent = `Unit ${n} • ${unit.title}`;
    $('#sideTitle').textContent = `Unit ${n} Lessons`;
    renderSidebar();
    renderPage();
    window.scrollTo(0,0);
};

window.backToOverview = function(){
    $('#unitPage').classList.remove('active');
    $('#overviewPage').classList.remove('hidden');
    window.scrollTo(0,0);
};

function keyPrefix(){ return 'memolearn_'+UNITS[state.unitId].id+'_'; }
function save(k,v){ try{ localStorage.setItem(keyPrefix()+k, JSON.stringify(v)); }catch(e){} }
function load(k,d){ try{ const v=localStorage.getItem(keyPrefix()+k); return v?JSON.parse(v):d; }catch(e){ return d; } }

function renderSidebar(){
    const unit = UNITS[state.unitId];
    const ul = $('#lessonList'); clear(ul);
    unit.sections.forEach((sec, si)=>{
        sec.pages.forEach((pg, pi)=>{
            const li = el('li');
            const a = el('a','lesson'); a.href='#'; a.dataset.s=si; a.dataset.p=pi;
            
            // Set active class if this is the current page
            if(state.sIdx === si && state.pIdx === pi) {
                a.classList.add('active');
            }
            
            const tag = el('span','tag'); tag.textContent = pg.tag||'Item';
            const title = el('span'); title.textContent = `${sec.title} — ${pg.label}`;
            const done = el('span','done'); done.innerHTML = '<i class="fas fa-check"></i> Completed';
            
            if(load('done_'+sec.id+'_'+pg.id,false)) {
                li.classList.add('completed');
            }
            
            a.appendChild(tag); 
            a.appendChild(title); 
            a.appendChild(done); 
            li.appendChild(a); 
            ul.appendChild(li);
        });
    });
    
    // Use property assignment to avoid stacking multiple listeners
    ul.onclick = (e)=>{
        const a = e.target.closest('a.lesson'); 
        if(!a) return; 
        e.preventDefault();
        state.sIdx = Number(a.dataset.s); 
        state.pIdx = Number(a.dataset.p); 
        renderPage();
    };
}

function renderPage(){
    const unit = UNITS[state.unitId];
    const sec = unit.sections[state.sIdx];
    const pg  = sec.pages[state.pIdx];
    
    $('#crumbs').innerHTML = `
        <span>Unit ${state.unitId}</span>
        <span>${sec.title}</span>
        <span>${pg.label}</span>
    `;
    
    $('#title').textContent  = sec.title;
    $('#lead').textContent   = (pg.lead || (pg.tag==='Quiz'?'Test your understanding':'Learn and practice'));

    const content = $('#content'); clear(content);
    (pg.blocks||[]).forEach(b=>{
        if(b.type==='p'){
            const p=el('p'); 
            p.innerHTML = b.text; 
            content.appendChild(p); 
        }
        if(b.type==='ex'){
            const d=el('div','example'); 
            const h=el('h4'); 
            h.innerHTML = `<i class="fas fa-lightbulb"></i> ${b.title||'Example'}`; 
            d.appendChild(h); 
            const p=el('p'); 
            p.innerHTML = b.text; 
            d.appendChild(p); 
            content.appendChild(d); 
        }
        if(b.type==='note'){
            const n=el('div','note'); 
            n.innerHTML = b.text; 
            content.appendChild(n); 
        }
        if(b.type==='warn'){
            const w=el('div','warn'); 
            w.innerHTML = b.text; 
            content.appendChild(w); 
        }
        if(b.type==='definition'){
            const def=el('div','definition');
            const h=el('h4');
            h.innerHTML = `<i class="fas fa-book"></i> ${b.title||'Definition'}`;
            def.appendChild(h);
            const p=el('p');
            p.innerHTML = b.text;
            def.appendChild(p);
            content.appendChild(def);
        }
        if(b.type==='highlight'){
            const highlight=el('div','highlight');
            const h=el('h4');
            h.innerHTML = `<i class="fas fa-star"></i> ${b.title||'Key Insight'}`;
            highlight.appendChild(h);
            const p=el('p');
            p.innerHTML = b.text;
            highlight.appendChild(p);
            content.appendChild(highlight);
        }
        if(b.type==='key-takeaways'){
            const kt=el('div','key-takeaways');
            const h=el('h4');
            h.innerHTML = `<i class="fas fa-check-circle"></i> ${b.title||'Key Takeaways'}`;
            kt.appendChild(h);
            
            if (typeof b.text === 'string') {
                const p=el('p');
                p.innerHTML = b.text;
                kt.appendChild(p);
            } else if (Array.isArray(b.text)) {
                const ul = el('ul');
                b.text.forEach(item => {
                    const li = el('li');
                    li.textContent = item;
                    ul.appendChild(li);
                });
                kt.appendChild(ul);
            }
            
            content.appendChild(kt);
        }
        if(b.type==='step-by-step'){
            const sbs=el('div','step-by-step');
            const h=el('h4');
            h.innerHTML = `<i class="fas fa-list-ol"></i> ${b.title||'Step-by-Step'}`;
            sbs.appendChild(h);
            
            if (Array.isArray(b.text)) {
                b.text.forEach((step, index) => {
                    const stepDiv = el('div', 'step');
                    const stepNum = el('div', 'step-number');
                    stepNum.textContent = index + 1;
                    const stepContent = el('div', 'step-content');
                    stepContent.innerHTML = step;
                    stepDiv.appendChild(stepNum);
                    stepDiv.appendChild(stepContent);
                    sbs.appendChild(stepDiv);
                });
            } else {
                const p=el('p');
                p.innerHTML = b.text;
                sbs.appendChild(p);
            }
            
            content.appendChild(sbs);
        }
        if(b.type==='real-world'){
            const rw=el('div','real-world');
            const h=el('h4');
            h.innerHTML = `<i class="fas fa-globe"></i> ${b.title||'Real-World Connection'}`;
            rw.appendChild(h);
            const p=el('p');
            p.innerHTML = b.text;
            rw.appendChild(p);
            content.appendChild(rw);
        }
    });

    renderPractice(pg); 
    renderQuiz(pg); 
    updateNavButtons(); 
    updateProgress();
    
    // Update active lesson in sidebar
    document.querySelectorAll('.lesson').forEach(lesson => {
        lesson.classList.remove('active');
    });
    
    const activeLesson = document.querySelector(`.lesson[data-s="${state.sIdx}"][data-p="${state.pIdx}"]`);
    if (activeLesson) {
        activeLesson.classList.add('active');
    }
}

function renderPractice(pg){
    const box = $('#practice'); clear(box);
    if(!pg.practice || !pg.practice.length) return;
    
    const h = el('h3'); 
    h.innerHTML = '<i class="fas fa-pencil-alt"></i> Practice Problems'; 
    box.appendChild(h);
    
    const desc = el('p');
    desc.textContent = 'Try solving these practice problems. Check your answers and review the solutions to deepen your understanding.';
    desc.style.marginBottom = '16px';
    desc.style.color = 'var(--muted)';
    box.appendChild(desc);
    
    pg.practice.forEach(p=>{
        const wrap = el('div','problem');
        const title = el('h5'); 
        title.innerHTML = `<i class="fas fa-question-circle"></i> ${p.prompt}`; 
        wrap.appendChild(title);
        
        const result = el('div');
        
        if(p.kind==='numeric'){
            const inputGroup = el('div');
            inputGroup.style.display = 'flex';
            inputGroup.style.gap = '8px';
            inputGroup.style.alignItems = 'center';
            inputGroup.style.flexWrap = 'wrap';
            
            const input = el('input','input'); 
            input.inputMode='decimal'; 
            input.placeholder='Enter a number';
            input.addEventListener('keypress', function(e) {
                if(e.key === 'Enter') {
                    checkAnswer();
                }
            });
            
            const btn = el('button','btn'); 
            btn.innerHTML = '<i class="fas fa-check"></i> Check'; 
            
            inputGroup.appendChild(input); 
            inputGroup.appendChild(btn); 
            wrap.appendChild(inputGroup); 
            wrap.appendChild(result);
            
            const checkAnswer = () => {
                const val = parseFloat(String(input.value).replace(/[^0-9+\-\.eE]/g,''));
                if(isNaN(val)){ 
                    result.className='bad'; 
                    result.innerHTML = '<i class="fas fa-times-circle"></i> Please enter a valid number.'; 
                    return; 
                }
                const ok = Math.abs(val - p.ans) <= (p.tol||1e-6);
                result.className = ok?'ok':'bad';
                result.innerHTML = ok 
                    ? '<i class="fas fa-check-circle"></i> Correct! Well done.' 
                    : '<i class="fas fa-times-circle"></i> Not quite. Try again.';
                
                if (ok) {
                    wrap.classList.add('correct-pulse');
                    setTimeout(() => wrap.classList.remove('correct-pulse'), 500);
                }
            };
            
            btn.onclick = checkAnswer;
        } else if(p.kind==='mc'){
            const opts = el('div');
            (p.options||[]).forEach((opt,i)=>{
                const lab = el('label','choice');
                const r = el('input'); 
                r.type='radio'; 
                r.name=p.id; 
                r.value=String(i);
                
                r.addEventListener('change', function() {
                    // Visual feedback when an option is selected
                    document.querySelectorAll(`input[name="${p.id}"]`).forEach(inp => {
                        inp.parentElement.style.background = '';
                        inp.parentElement.style.borderColor = '';
                    });
                    if (this.checked) {
                        this.parentElement.style.background = '#f0f4ff';
                        this.parentElement.style.borderColor = 'var(--indigo)';
                    }
                });
                
                const s = el('span'); 
                s.textContent=opt; 
                lab.appendChild(r); 
                lab.appendChild(s); 
                opts.appendChild(lab);
            });
            
            const btn = el('button','btn'); 
            btn.innerHTML = '<i class="fas fa-check"></i> Check'; 
            btn.style.marginTop='12px';
            
            wrap.appendChild(opts); 
            wrap.appendChild(btn); 
            wrap.appendChild(result);
            
            btn.onclick = ()=>{
                const chosen = Array.from(opts.querySelectorAll('input')).find(i=>i.checked);
                if(!chosen){ 
                    result.className='bad'; 
                    result.innerHTML = '<i class="fas fa-times-circle"></i> Please select an option.'; 
                    return; 
                }
                const ok = Number(chosen.value)===p.correct; 
                result.className=ok?'ok':'bad';
                result.innerHTML = ok 
                    ? '<i class="fas fa-check-circle"></i> Correct!' 
                    : '<i class="fas fa-times-circle"></i> Incorrect. Try again.';
                
                if (ok) {
                    wrap.classList.add('correct-pulse');
                    setTimeout(() => wrap.classList.remove('correct-pulse'), 500);
                }
            };
        }
        
        const help = el('span','help'); 
        help.innerHTML = '<i class="fas fa-lightbulb"></i> Show solution';
        const sol = el('div','solution'); 
        sol.innerHTML = p.sol||'Solution coming soon.';
        
        help.onclick=()=>{ 
            sol.style.display = sol.style.display==='block'?'none':'block'; 
            help.innerHTML = sol.style.display==='block' 
                ? '<i class="fas fa-eye-slash"></i> Hide solution' 
                : '<i class="fas fa-lightbulb"></i> Show solution';
        };
        
        wrap.appendChild(help); 
        wrap.appendChild(sol); 
        box.appendChild(wrap);
    });
}

function renderQuiz(pg){
    const box = $('#quiz'); clear(box);
    if(!pg.quiz || !pg.quiz.length) return;
    
    const h = el('h3'); 
    h.innerHTML = '<i class="fas fa-tasks"></i> Quiz'; 
    box.appendChild(h);
    
    const desc = el('p');
    desc.textContent = 'Test your knowledge with this quick quiz. Submit your answers to see your score and review explanations.';
    desc.style.marginBottom = '16px';
    desc.style.color = 'var(--muted)';
    box.appendChild(desc);
    
    const qs = el('div'); 
    box.appendChild(qs);
    
    (pg.quiz||[]).forEach((q,idx)=>{
        const qEl = el('div','q');
        const title = el('h5'); 
        title.innerHTML = `<i class="fas fa-question"></i> ${idx+1}. ${q.q}`; 
        qEl.appendChild(title);
        
        (q.opts||[]).forEach((opt,i)=>{
            const lab = el('label','choice'); 
            const r=el('input'); 
            r.type='radio'; 
            r.name=q.id; 
            r.value=String(i);
            
            const s = el('span'); 
            s.textContent=opt; 
            lab.appendChild(r); 
            lab.appendChild(s); 
            qEl.appendChild(lab);
        });
        qs.appendChild(qEl);
    });
    
    const toolbar = el('div'); 
    toolbar.style.display='flex'; 
    toolbar.style.gap='12px'; 
    toolbar.style.marginTop='20px';
    toolbar.style.alignItems = 'center';
    
    const submit = el('button','btn'); 
    submit.innerHTML = '<i class="fas fa-paper-plane"></i> Submit'; 
    
    const reset = el('button','btn secondary'); 
    reset.innerHTML = '<i class="fas fa-redo"></i> Reset'; 
    reset.style.display='none';
    
    const score = el('div', 'score-display'); 
    toolbar.appendChild(submit); 
    toolbar.appendChild(reset); 
    toolbar.appendChild(score); 
    box.appendChild(toolbar);

    submit.onclick=()=>{
        let correct=0; 
        const total=(pg.quiz||[]).length;
        
        (pg.quiz||[]).forEach((q,i)=>{
            const chosen = document.querySelector(`input[name="${q.id}"]:checked`);
            const block = qs.children[i];
            
            // Remove any previous result
            const prevResult = block.querySelector('.quiz-result');
            if (prevResult) prevResult.remove();
            
            const res = el('div', 'quiz-result');
            res.style.marginTop = '10px';
            
            if(chosen && Number(chosen.value)===q.a){
                res.className='ok'; 
                res.innerHTML = `<i class="fas fa-check-circle"></i> Correct — ${q.exp}`;
                correct++; 
                
                // Visual feedback
                chosen.parentElement.style.background = '#d1fae5';
                chosen.parentElement.style.borderColor = 'var(--success)';
            } else { 
                res.className='bad'; 
                res.innerHTML = `<i class="fas fa-times-circle"></i> Incorrect — Correct answer: ${q.opts[q.a]}. ${q.exp}`;
                
                // Highlight correct answer
                const correctOption = block.querySelector(`input[name="${q.id}"][value="${q.a}"]`);
                if (correctOption) {
                    correctOption.parentElement.style.background = '#fee2e2';
                    correctOption.parentElement.style.borderColor = 'var(--danger)';
                }
                
                // Highlight incorrect selection if any
                if (chosen) {
                    chosen.parentElement.style.background = '#fef3c7';
                    chosen.parentElement.style.borderColor = 'var(--warning)';
                }
            }
            block.appendChild(res);
        });
        
        const percentage = Math.round(100*correct/Math.max(1,total));
        score.textContent = `Score: ${correct}/${total} (${percentage}%)`;
        
        // Color code based on performance
        if (percentage >= 80) {
            score.style.color = 'var(--success)';
        } else if (percentage >= 60) {
            score.style.color = 'var(--warning)';
        } else {
            score.style.color = 'var(--danger)';
        }
        
        reset.style.display='inline-block'; 
        submit.disabled=true;
        
        // Mark as completed if score is good (optional)
        if (correct >= total * 0.7) {
            const unit = UNITS[state.unitId]; 
            const sec=unit.sections[state.sIdx]; 
            const pgc=sec.pages[state.pIdx];
            save('done_'+sec.id+'_'+pgc.id,true); 
            renderSidebar();
        }
    };
    
    reset.onclick=()=>{ 
        renderPage(); 
    };
}

function updateNavButtons(){
    const unit = UNITS[state.unitId];
    const isFirst = state.sIdx===0 && state.pIdx===0;
    const isLast  = state.sIdx===unit.sections.length-1 && state.pIdx===unit.sections[state.sIdx].pages.length-1;
    
    $('#prevBtn').disabled = isFirst; 
    $('#nextBtn').disabled = isLast;
    
    $('#prevBtn').onclick = goPrev; 
    $('#nextBtn').onclick = goNext;
    
    // Update next button text
    $('#nextBtn').innerHTML = isLast 
        ? 'Finish <i class="fas fa-flag-checkered"></i>' 
        : 'Next <i class="fas fa-arrow-right"></i>';
}

function goPrev(){ 
    const unit=UNITS[state.unitId]; 
    if(state.pIdx>0) {
        state.pIdx--; 
    } else if(state.sIdx>0){ 
        state.sIdx--; 
        state.pIdx=unit.sections[state.sIdx].pages.length-1; 
    } 
    renderPage(); 
    window.scrollTo(0,0);
}

function goNext(){ 
    const unit=UNITS[state.unitId]; 
    if(state.pIdx<unit.sections[state.sIdx].pages.length-1) {
        state.pIdx++; 
    } else if(state.sIdx<unit.sections.length-1){ 
        state.sIdx++; 
        state.pIdx=0; 
    } 
    renderPage(); 
    window.scrollTo(0,0);
}

function updateProgress(){
    const unit = UNITS[state.unitId]; 
    let total=0, done=0;
    
    unit.sections.forEach(sec=>{
        sec.pages.forEach(pg=>{ 
            total++; 
            if(load('done_'+sec.id+'_'+pg.id,false)) done++; 
        });
    });
    
    const pct = Math.round(100*done/Math.max(1,total));
    $('#progressbar').style.width=pct+'%';
    $('#progressText').textContent = `${pct}% Complete`;
}

// Initialize the page
document.addEventListener('DOMContentLoaded', function() {
    // Add any initialization code if needed
});
</script>
</body>
</html>
