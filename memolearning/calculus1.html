<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MemoLearning - Calculus I</title>
    <meta name="description" content="Interactive calculus learning platform with comprehensive lessons, quizzes, and progress tracking.">
    
    <!-- MathJax -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)']],
                displayMath: [['\\[', '\\]']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            --primary: 250 40% 60%;
            --primary-foreground: 0 0% 98%;
            --secondary: 250 20% 95%;
            --secondary-foreground: 250 10% 20%;
            --background: 0 0% 100%;
            --foreground: 250 10% 15%;
            --muted: 250 20% 96%;
            --muted-foreground: 250 10% 45%;
            --accent: 250 30% 92%;
            --accent-foreground: 250 20% 20%;
            --border: 250 20% 85%;
            --success: 142 76% 36%;
            --warning: 38 92% 50%;
            --destructive: 0 84% 60%;
            
            --radius: 0.75rem;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: hsl(var(--background));
            color: hsl(var(--foreground));
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }
        
        .header {
            background: linear-gradient(135deg, hsl(var(--primary)), hsl(250 60% 70%));
            color: hsl(var(--primary-foreground));
            padding: 2rem 0;
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .header p {
            font-size: 1.125rem;
            opacity: 0.9;
        }
        
        .card {
            background: hsl(var(--background));
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            transition: all 0.2s ease;
            overflow: hidden;
        }
        
        .card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }
        
        .card-header {
            padding: 1.5rem;
            border-bottom: 1px solid hsl(var(--border));
        }
        
        .card-content {
            padding: 1.5rem;
        }
        
        .card-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: hsl(var(--primary));
        }
        
        .grid {
            display: grid;
            gap: 1.5rem;
        }
        
        .grid-2 {
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }
        
        .grid-3 {
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius);
            font-weight: 500;
            text-decoration: none;
            transition: all 0.2s ease;
            cursor: pointer;
            border: none;
            font-size: 0.875rem;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
        }
        
        .btn-primary:hover {
            background: hsl(var(--primary) / 0.9);
        }
        
        .btn-secondary {
            background: hsl(var(--secondary));
            color: hsl(var(--secondary-foreground));
        }
        
        .btn-secondary:hover {
            background: hsl(var(--secondary) / 0.8);
        }
        
        .btn-outline {
            background: transparent;
            border: 1px solid hsl(var(--border));
            color: hsl(var(--foreground));
        }
        
        .btn-outline:hover {
            background: hsl(var(--accent));
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: linear-gradient(135deg, hsl(var(--primary)), hsl(250 60% 70%));
            color: hsl(var(--primary-foreground));
            padding: 1.5rem;
            border-radius: var(--radius);
            text-align: center;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }
        
        .stat-label {
            font-size: 0.875rem;
            opacity: 0.9;
        }
        
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            color: hsl(var(--muted-foreground));
        }
        
        .breadcrumb a {
            color: hsl(var(--primary));
            text-decoration: none;
        }
        
        .breadcrumb a:hover {
            text-decoration: underline;
        }
        
        .unit-layout {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 2rem;
            height: calc(100vh - 200px);
        }
        
        .sidebar {
            background: hsl(var(--muted));
            border-radius: var(--radius);
            padding: 1rem;
            overflow-y: auto;
        }
        
        .lesson-list {
            list-style: none;
        }
        
        .lesson-item {
            padding: 0.75rem;
            margin-bottom: 0.25rem;
            border-radius: calc(var(--radius) - 2px);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s ease;
        }
        
        .lesson-item:hover {
            background: hsl(var(--accent));
        }
        
        .lesson-item.active {
            background: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
        }
        
        .lesson-item.completed {
            background: hsl(var(--success) / 0.1);
            color: hsl(var(--success));
        }
        
        .content-area {
            background: hsl(var(--background));
            border-radius: var(--radius);
            padding: 2rem;
            overflow-y: auto;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: hsl(var(--muted));
            border-radius: 4px;
            margin: 1rem 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, hsl(var(--primary)), hsl(250 60% 70%));
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        .toggle-section {
            margin: 1.5rem 0;
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            overflow: hidden;
        }
        
        .toggle-header {
            background: hsl(var(--muted));
            padding: 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 500;
        }
        
        .toggle-content {
            padding: 1.5rem;
            background: hsl(var(--background));
            display: none;
        }
        
        .toggle-content.open {
            display: block;
            animation: slideDown 0.3s ease;
        }
        
        .quiz-question {
            background: hsl(var(--accent));
            padding: 1.5rem;
            border-radius: var(--radius);
            margin-bottom: 1.5rem;
        }
        
        .quiz-options {
            list-style: none;
            margin-top: 1rem;
        }
        
        .quiz-option {
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background: hsl(var(--background));
            border: 1px solid hsl(var(--border));
            border-radius: calc(var(--radius) - 2px);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .quiz-option:hover {
            background: hsl(var(--muted));
        }
        
        .quiz-option.selected {
            background: hsl(var(--primary) / 0.1);
            border-color: hsl(var(--primary));
        }
        
        .quiz-option.correct {
            background: hsl(var(--success) / 0.1);
            border-color: hsl(var(--success));
        }
        
        .quiz-option.incorrect {
            background: hsl(var(--destructive) / 0.1);
            border-color: hsl(var(--destructive));
        }
        
        .quiz-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid hsl(var(--border));
            border-radius: calc(var(--radius) - 2px);
            margin-top: 1rem;
            font-size: 1rem;
        }
        
        .quiz-feedback {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: calc(var(--radius) - 2px);
            font-weight: 500;
        }
        
        .quiz-feedback.correct {
            background: hsl(var(--success) / 0.1);
            color: hsl(var(--success));
            border: 1px solid hsl(var(--success) / 0.3);
        }
        
        .quiz-feedback.incorrect {
            background: hsl(var(--destructive) / 0.1);
            color: hsl(var(--destructive));
            border: 1px solid hsl(var(--destructive) / 0.3);
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid hsl(var(--border));
        }
        
        .topic-list {
            list-style: none;
            margin-top: 1rem;
        }
        
        .topic-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0;
            color: hsl(var(--muted-foreground));
            font-size: 0.875rem;
        }
        
        .unit-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 2rem;
            height: 2rem;
            background: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
            border-radius: 50%;
            font-weight: 600;
            margin-right: 1rem;
        }
        
        .hidden {
            display: none !important;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .unit-layout {
                grid-template-columns: 1fr;
                height: auto;
            }
            
            .sidebar {
                order: 2;
                max-height: 300px;
            }
            
            .content-area {
                order: 1;
            }
            
            .container {
                padding: 0.5rem;
            }
            
            .card-header,
            .card-content {
                padding: 1rem;
            }
        }
        
        /* Focus styles for accessibility */
        .btn:focus,
        .lesson-item:focus,
        .quiz-option:focus,
        .toggle-header:focus {
            outline: 2px solid hsl(var(--primary));
            outline-offset: 2px;
        }
        
        /* Screen reader only content */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
    </style>
</head>
<body>
    <div id="overviewPage">
        <div class="header">
            <div class="container">
                <h1>MemoLearning</h1>
                <p>Master calculus with interactive lessons and practice</p>
            </div>
        </div>
        
        <div class="container">
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalLessons">0</div>
                    <div class="stat-label">Total Lessons</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="completedLessons">0</div>
                    <div class="stat-label">Completed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="progressPercent">0%</div>
                    <div class="stat-label">Progress</div>
                </div>
            </div>
            
            <div class="grid grid-2">
                <div class="card" onclick="openCourse('calc1')" tabindex="0" role="button" aria-label="Open Calculus I course">
                    <div class="card-header">
                        <h2 class="card-title">Calculus I</h2>
                        <p>Comprehensive introduction to limits, derivatives, and integrals</p>
                    </div>
                    <div class="card-content">
                        <p><strong>8 Units</strong> • <strong>65+ Lessons</strong> • <strong>8 Quizzes</strong></p>
                        <div class="progress-bar" style="margin-top: 1rem;">
                            <div class="progress-fill" id="calc1Progress" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="coursePage" class="hidden">
        <div class="header">
            <div class="container">
                <div class="breadcrumb">
                    <a href="#" onclick="showOverview()">Overview</a>
                    <i class="fas fa-chevron-right"></i>
                    <span>Calculus I</span>
                </div>
                <h1>Calculus I</h1>
                <p>Build a strong foundation in calculus concepts and applications</p>
            </div>
        </div>
        
        <div class="container">
            <div class="grid grid-3" id="unitsGrid"></div>
        </div>
    </div>
    
    <div id="unitPage" class="hidden">
        <div class="header">
            <div class="container">
                <div class="breadcrumb">
                    <a href="#" onclick="showOverview()">Overview</a>
                    <i class="fas fa-chevron-right"></i>
                    <a href="#" onclick="openCourse('calc1')">Calculus I</a>
                    <i class="fas fa-chevron-right"></i>
                    <span id="unitBreadcrumb">Unit 1</span>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h1 id="unitTitle">Unit 1 - Limits & Continuity</h1>
                    <div>
                        <button class="btn btn-outline" onclick="resetProgress()">
                            <i class="fas fa-redo"></i> Reset Progress
                        </button>
                        <button class="btn btn-secondary" onclick="window.print()">
                            <i class="fas fa-print"></i> Print
                        </button>
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="unitProgress"></div>
                </div>
            </div>
        </div>
        
        <div class="container">
            <div class="unit-layout">
                <div class="sidebar">
                    <h3 style="margin-bottom: 1rem;">Lessons</h3>
                    <ul class="lesson-list" id="lessonList"></ul>
                </div>
                
                <div class="content-area" id="contentArea">
                    <div id="lessonContent"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Course data structure
        const courseData = {
            calc1: {
                id: 'calc1',
                title: 'Calculus I',
                description: 'Comprehensive introduction to limits, derivatives, and integrals',
                units: {
                    1: {
                        id: 1,
                        title: 'Limits & Continuity',
                        topics: [
                            'Limit definition and intuitive understanding',
                            'Evaluating limits algebraically and graphically',
                            'One-sided limits and infinite limits',
                            'Continuity at a point and on intervals',
                            'Intermediate Value Theorem',
                            'Limits at infinity and horizontal asymptotes',
                            'Squeeze Theorem'
                        ],
                        lessons: {
                            'u1l1': {
                                id: 'u1l1',
                                title: 'Introduction to Limits',
                                content: `
                                    <h2>Introduction to Limits</h2>
                                    <p class="lead">Limits are fundamental to understanding calculus. They describe the behavior of functions as inputs approach specific values.</p>
                                    
                                    <h3>What is a Limit?</h3>
                                    <p>The limit of a function \\(f(x)\\) as \\(x\\) approaches \\(a\\) is the value that \\(f(x)\\) gets arbitrarily close to as \\(x\\) gets arbitrarily close to \\(a\\).</p>
                                    
                                    <p>We write this as: \\[\\lim_{x \\to a} f(x) = L\\]</p>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header" onclick="toggleContent(this)">
                                            <span>Example: Finding a Simple Limit</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p><strong>Find:</strong> \\(\\lim_{x \\to 2} (3x + 1)\\)</p>
                                            <p><strong>Solution:</strong> Since this is a polynomial function, we can substitute directly:</p>
                                            <p>\\(\\lim_{x \\to 2} (3x + 1) = 3(2) + 1 = 7\\)</p>
                                        </div>
                                    </div>
                                    
                                    <h3>Intuitive Understanding</h3>
                                    <p>Think of limits as asking "What value is the function approaching?" rather than "What value does the function equal?"</p>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header" onclick="toggleContent(this)">
                                            <span>Practice Problem</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p><strong>Problem:</strong> What is \\(\\lim_{x \\to 3} (x^2 - 4x + 5)\\)?</p>
                                            <p><strong>Solution:</strong> \\(\\lim_{x \\to 3} (x^2 - 4x + 5) = 3^2 - 4(3) + 5 = 9 - 12 + 5 = 2\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u1l2': {
                                id: 'u1l2',
                                title: 'Evaluating Limits Algebraically',
                                content: `
                                    <h2>Evaluating Limits Algebraically</h2>
                                    <p class="lead">Learn systematic methods for computing limits using algebraic techniques.</p>
                                    
                                    <h3>Direct Substitution</h3>
                                    <p>For continuous functions, we can often find limits by direct substitution:</p>
                                    <p>If \\(f\\) is continuous at \\(x = a\\), then \\(\\lim_{x \\to a} f(x) = f(a)\\)</p>
                                    
                                    <h3>Factoring Technique</h3>
                                    <p>When direct substitution gives \\(\\frac{0}{0}\\), try factoring:</p>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header" onclick="toggleContent(this)">
                                            <span>Example: Limit with Factoring</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p><strong>Find:</strong> \\(\\lim_{x \\to 2} \\frac{x^2 - 4}{x - 2}\\)</p>
                                            <p><strong>Solution:</strong></p>
                                            <p>Direct substitution gives \\(\\frac{0}{0}\\), so we factor:</p>
                                            <p>\\(\\frac{x^2 - 4}{x - 2} = \\frac{(x-2)(x+2)}{x-2} = x + 2\\) (for \\(x \\neq 2\\))</p>
                                            <p>Therefore: \\(\\lim_{x \\to 2} \\frac{x^2 - 4}{x - 2} = \\lim_{x \\to 2} (x + 2) = 4\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u1l3': {
                                id: 'u1l3',
                                title: 'One-sided Limits',
                                content: `
                                    <h2>One-sided Limits</h2>
                                    <p class="lead">Sometimes we need to consider what happens as we approach a point from only one direction.</p>
                                    
                                    <h3>Left-hand and Right-hand Limits</h3>
                                    <p>Left-hand limit: \\(\\lim_{x \\to a^-} f(x)\\) (approaching from the left)</p>
                                    <p>Right-hand limit: \\(\\lim_{x \\to a^+} f(x)\\) (approaching from the right)</p>
                                    
                                    <p>The two-sided limit exists if and only if both one-sided limits exist and are equal.</p>
                                `
                            },
                            'u1l4': {
                                id: 'u1l4',
                                title: 'Continuity',
                                content: `
                                    <h2>Continuity</h2>
                                    <p class="lead">A function is continuous if there are no breaks, jumps, or holes in its graph.</p>
                                    
                                    <h3>Definition of Continuity</h3>
                                    <p>A function \\(f\\) is continuous at \\(x = a\\) if:</p>
                                    <ol>
                                        <li>\\(f(a)\\) is defined</li>
                                        <li>\\(\\lim_{x \\to a} f(x)\\) exists</li>
                                        <li>\\(\\lim_{x \\to a} f(x) = f(a)\\)</li>
                                    </ol>
                                `
                            },
                            'u1l5': {
                                id: 'u1l5',
                                title: 'Intermediate Value Theorem',
                                content: `
                                    <h2>Intermediate Value Theorem</h2>
                                    <p class="lead">If a function is continuous, it takes on all values between any two of its values.</p>
                                    
                                    <h3>Statement of the Theorem</h3>
                                    <p>If \\(f\\) is continuous on \\([a,b]\\) and \\(k\\) is any number between \\(f(a)\\) and \\(f(b)\\), then there exists \\(c \\in (a,b)\\) such that \\(f(c) = k\\).</p>
                                `
                            },
                            'u1l6': {
                                id: 'u1l6',
                                title: 'Limits at Infinity',
                                content: `
                                    <h2>Limits at Infinity</h2>
                                    <p class="lead">Explore what happens to functions as the input grows without bound.</p>
                                    
                                    <h3>Horizontal Asymptotes</h3>
                                    <p>If \\(\\lim_{x \\to \\infty} f(x) = L\\), then \\(y = L\\) is a horizontal asymptote.</p>
                                `
                            },
                            'u1l7': {
                                id: 'u1l7',
                                title: 'Squeeze Theorem',
                                content: `
                                    <h2>Squeeze Theorem</h2>
                                    <p class="lead">A powerful technique for finding limits when direct methods fail.</p>
                                    
                                    <h3>Statement of the Theorem</h3>
                                    <p>If \\(g(x) \\leq f(x) \\leq h(x)\\) for all \\(x\\) near \\(a\\), and \\(\\lim_{x \\to a} g(x) = \\lim_{x \\to a} h(x) = L\\), then \\(\\lim_{x \\to a} f(x) = L\\).</p>
                                `
                            },
                            'u1l8': {
                                id: 'u1l8',
                                title: 'Review and Applications',
                                content: `
                                    <h2>Review and Applications</h2>
                                    <p class="lead">Consolidate your understanding of limits and continuity.</p>
                                    
                                    <h3>Key Concepts to Remember</h3>
                                    <ul>
                                        <li>Limits describe behavior near a point</li>
                                        <li>Continuity means no breaks in the graph</li>
                                        <li>One-sided limits help analyze discontinuities</li>
                                        <li>The Squeeze Theorem is powerful for tricky limits</li>
                                    </ul>
                                `
                            }
                        },
                        quiz: {
                            questions: [
                                {
                                    type: 'multiple-choice',
                                    question: 'What is \\(\\lim_{x \\to 3} (2x + 1)\\)?',
                                    options: ['5', '6', '7', '8'],
                                    correct: 2,
                                    feedback: 'Direct substitution: \\(2(3) + 1 = 7\\)'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'For a function to be continuous at \\(x = a\\), which conditions must be met?',
                                    options: [
                                        'Only \\(f(a)\\) must be defined',
                                        'Only the limit must exist',
                                        '\\(f(a)\\) defined, limit exists, and they are equal',
                                        'The function must be differentiable'
                                    ],
                                    correct: 2,
                                    feedback: 'All three conditions for continuity must be satisfied.'
                                },
                                {
                                    type: 'numeric',
                                    question: 'Find \\(\\lim_{x \\to 2} \\frac{x^2 - 4}{x - 2}\\)',
                                    answer: 4,
                                    tolerance: 0.1,
                                    feedback: 'Factor the numerator: \\((x-2)(x+2)/(x-2) = x+2\\), so the limit is 4.'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'What type of discontinuity occurs when the left and right limits exist but are not equal?',
                                    options: ['Removable', 'Jump', 'Infinite', 'Oscillatory'],
                                    correct: 1,
                                    feedback: 'A jump discontinuity occurs when one-sided limits exist but differ.'
                                },
                                {
                                    type: 'numeric',
                                    question: 'If \\(\\lim_{x \\to \\infty} \\frac{3x + 2}{x - 1}\\), what is the horizontal asymptote?',
                                    answer: 3,
                                    tolerance: 0.1,
                                    feedback: 'For rational functions, divide by highest power: the limit is 3.'
                                }
                            ]
                        }
                    },
                    2: {
                        id: 2,
                        title: 'Derivatives',
                        topics: [
                            'Definition of derivative as a limit',
                            'Geometric interpretation: tangent lines',
                            'Differentiability vs. continuity',
                            'Basic differentiation rules',
                            'Power rule, constant rule, sum rule',
                            'Derivatives of polynomial functions',
                            'Higher-order derivatives'
                        ],
                        lessons: {
                            'u2l1': {
                                id: 'u2l1',
                                title: 'Definition of the Derivative',
                                content: `
                                    <h2>Definition of the Derivative</h2>
                                    <p class="lead">The derivative measures the instantaneous rate of change of a function.</p>
                                    
                                    <h3>Formal Definition</h3>
                                    <p>The derivative of \\(f(x)\\) at \\(x = a\\) is:</p>
                                    \\[f'(a) = \\lim_{h \\to 0} \\frac{f(a+h) - f(a)}{h}\\]
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Find the derivative of \\(f(x) = x^2\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p><strong>Solution:</strong></p>
                                            <p>\\[f'(x) = \\lim_{h \\to 0} \\frac{(x+h)^2 - x^2}{h}\\]</p>
                                            <p>\\[= \\lim_{h \\to 0} \\frac{x^2 + 2xh + h^2 - x^2}{h}\\]</p>
                                            <p>\\[= \\lim_{h \\to 0} \\frac{2xh + h^2}{h}\\]</p>
                                            <p>\\[= \\lim_{h \\to 0} (2x + h) = 2x\\]</p>
                                        </div>
                                    </div>
                                    
                                    <h3>Geometric Interpretation</h3>
                                    <p>The derivative represents the slope of the tangent line to the curve at a given point.</p>
                                `
                            },
                            'u2l2': {
                                id: 'u2l2',
                                title: 'Geometric Interpretation',
                                content: `
                                    <h2>Geometric Interpretation of Derivatives</h2>
                                    <p class="lead">Understanding derivatives as slopes of tangent lines.</p>
                                    
                                    <h3>Tangent Line</h3>
                                    <p>The tangent line to a curve at point \\((a, f(a))\\) has slope \\(f'(a)\\).</p>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Tangent line to \\(y = x^2\\) at \\(x = 2\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p><strong>Solution:</strong></p>
                                            <ol>
                                                <li>Find the point: \\((2, 4)\\)</li>
                                                <li>Find the slope: \\(f'(2) = 2(2) = 4\\)</li>
                                                <li>Use point-slope form: \\(y - 4 = 4(x - 2)\\)</li>
                                                <li>Tangent line: \\(y = 4x - 4\\)</li>
                                            </ol>
                                        </div>
                                    </div>
                                `
                            },
                            'u2l3': {
                                id: 'u2l3',
                                title: 'Differentiability and Continuity',
                                content: `
                                    <h2>Differentiability and Continuity</h2>
                                    <p class="lead">Exploring the relationship between differentiability and continuity.</p>
                                    
                                    <h3>Key Relationship</h3>
                                    <p>If \\(f\\) is differentiable at \\(x = a\\), then \\(f\\) is continuous at \\(x = a\\).</p>
                                    <p><strong>Note:</strong> The converse is not true! Continuity does not guarantee differentiability.</p>
                                    
                                    <h3>Common Cases of Non-differentiability</h3>
                                    <ul>
                                        <li><strong>Sharp corners:</strong> \\(f(x) = |x|\\) at \\(x = 0\\)</li>
                                        <li><strong>Vertical tangents:</strong> \\(f(x) = x^{1/3}\\) at \\(x = 0\\)</li>
                                        <li><strong>Discontinuities:</strong> Any point where function is not continuous</li>
                                    </ul>
                                `
                            },
                            'u2l4': {
                                id: 'u2l4',
                                title: 'Basic Differentiation Rules',
                                content: `
                                    <h2>Basic Differentiation Rules</h2>
                                    <p class="lead">Essential rules that make finding derivatives efficient.</p>
                                    
                                    <h3>Constant Rule</h3>
                                    <p>\\[\\frac{d}{dx}[c] = 0\\]</p>
                                    
                                    <h3>Power Rule</h3>
                                    <p>\\[\\frac{d}{dx}[x^n] = nx^{n-1}\\]</p>
                                    
                                    <h3>Constant Multiple Rule</h3>
                                    <p>\\[\\frac{d}{dx}[cf(x)] = c\\frac{d}{dx}[f(x)]\\]</p>
                                    
                                    <h3>Sum Rule</h3>
                                    <p>\\[\\frac{d}{dx}[f(x) + g(x)] = f'(x) + g'(x)\\]</p>
                                `
                            },
                            'u2l5': {
                                id: 'u2l5',
                                title: 'Power Rule Applications',
                                content: `
                                    <h2>Power Rule Applications</h2>
                                    <p class="lead">Master the most fundamental differentiation rule.</p>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Find \\(\\frac{d}{dx}[3x^4 - 2x^3 + 5x - 7]\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p><strong>Solution:</strong></p>
                                            <p>\\[\\frac{d}{dx}[3x^4] = 3 \\cdot 4x^3 = 12x^3\\]</p>
                                            <p>\\[\\frac{d}{dx}[-2x^3] = -2 \\cdot 3x^2 = -6x^2\\]</p>
                                            <p>\\[\\frac{d}{dx}[5x] = 5\\]</p>
                                            <p>\\[\\frac{d}{dx}[-7] = 0\\]</p>
                                            <p><strong>Answer:</strong> \\(12x^3 - 6x^2 + 5\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u2l6': {
                                id: 'u2l6',
                                title: 'Polynomial Functions',
                                content: `
                                    <h2>Derivatives of Polynomial Functions</h2>
                                    <p class="lead">Apply differentiation rules to polynomial functions.</p>
                                    
                                    <h3>General Form</h3>
                                    <p>For \\(P(x) = a_nx^n + a_{n-1}x^{n-1} + \\cdots + a_1x + a_0\\)</p>
                                    <p>\\[P'(x) = na_nx^{n-1} + (n-1)a_{n-1}x^{n-2} + \\cdots + a_1\\]</p>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Practice Problem</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p><strong>Problem:</strong> Find the derivative of \\(f(x) = x^5 - 3x^4 + 2x^2 - 8\\)</p>
                                            <p><strong>Solution:</strong> \\(f'(x) = 5x^4 - 12x^3 + 4x\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u2l7': {
                                id: 'u2l7',
                                title: 'Higher-Order Derivatives',
                                content: `
                                    <h2>Higher-Order Derivatives</h2>
                                    <p class="lead">Derivatives of derivatives reveal important properties of functions.</p>
                                    
                                    <h3>Notation</h3>
                                    <ul>
                                        <li>Second derivative: \\(f''(x)\\), \\(\\frac{d^2f}{dx^2}\\)</li>
                                        <li>Third derivative: \\(f'''(x)\\), \\(\\frac{d^3f}{dx^3}\\)</li>
                                        <li>nth derivative: \\(f^{(n)}(x)\\), \\(\\frac{d^nf}{dx^n}\\)</li>
                                    </ul>
                                    
                                    <h3>Physical Interpretation</h3>
                                    <ul>
                                        <li>Position: \\(s(t)\\)</li>
                                        <li>Velocity: \\(v(t) = s'(t)\\)</li>
                                        <li>Acceleration: \\(a(t) = v'(t) = s''(t)\\)</li>
                                    </ul>
                                `
                            },
                            'u2l8': {
                                id: 'u2l8',
                                title: 'Review and Applications',
                                content: `
                                    <h2>Review and Applications</h2>
                                    <p class="lead">Consolidate your understanding of basic derivatives.</p>
                                    
                                    <h3>Key Concepts</h3>
                                    <ul>
                                        <li>Derivative as instantaneous rate of change</li>
                                        <li>Geometric interpretation as slope of tangent line</li>
                                        <li>Differentiability implies continuity</li>
                                        <li>Basic differentiation rules</li>
                                        <li>Higher-order derivatives and their meaning</li>
                                    </ul>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Summary Example</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p><strong>Find all derivatives up to the 4th for:</strong> \\(f(x) = 2x^4 - 3x^3 + x^2 - 5x + 1\\)</p>
                                            <p>\\(f'(x) = 8x^3 - 9x^2 + 2x - 5\\)</p>
                                            <p>\\(f''(x) = 24x^2 - 18x + 2\\)</p>
                                            <p>\\(f'''(x) = 48x - 18\\)</p>
                                            <p>\\(f^{(4)}(x) = 48\\)</p>
                                        </div>
                                    </div>
                                `
                            }
                        },
                        quiz: {
                            questions: [
                                {
                                    type: 'multiple-choice',
                                    question: 'What does the derivative represent geometrically?',
                                    options: ['Area under curve', 'Slope of tangent line', 'Y-intercept', 'X-intercept'],
                                    correct: 1,
                                    feedback: 'The derivative gives the slope of the tangent line at a point.'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'If a function is differentiable at a point, then it is:',
                                    options: ['Continuous at that point', 'Discontinuous at that point', 'Has a vertical tangent', 'Has a sharp corner'],
                                    correct: 0,
                                    feedback: 'Differentiability implies continuity.'
                                },
                                {
                                    type: 'numeric',
                                    question: 'Find \\(\\frac{d}{dx}[x^7]\\)',
                                    answer: '7x^6',
                                    feedback: 'Using the power rule: \\(\\frac{d}{dx}[x^7] = 7x^6\\)'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'What is \\(\\frac{d}{dx}[5x^3 - 2x + 7]\\)?',
                                    options: ['\\(15x^2 - 2\\)', '\\(5x^2 - 2x\\)', '\\(15x^2 - 2x + 7\\)', '\\(15x^3 - 2\\)'],
                                    correct: 0,
                                    feedback: 'Apply the power rule to each term: \\(15x^2 - 2\\)'
                                },
                                {
                                    type: 'numeric',
                                    question: 'If \\(f(x) = x^4\\), find \\(f\'\'(2)\\)',
                                    answer: 24,
                                    tolerance: 0.1,
                                    feedback: '\\(f\'(x) = 4x^3\\), \\(f\'\'(x) = 12x^2\\), so \\(f\'\'(2) = 12(4) = 48\\). Wait, that\'s wrong - \\(f\'\'(2) = 12(2^2) = 24\\)'
                                }
                            ]
                        }
                    },
                    3: {
                        id: 3,
                        title: 'Differentiation Rules',
                        topics: [
                            'Product rule and quotient rule',
                            'Chain rule and composite functions',
                            'Derivatives of trigonometric functions',
                            'Derivatives of exponential functions',
                            'Derivatives of logarithmic functions',
                            'Derivatives of inverse trig functions',
                            'Implicit differentiation',
                            'Related rates problems'
                        ],
                        lessons: {
                            'u3l1': {
                                id: 'u3l1',
                                title: 'Product Rule and Quotient Rule',
                                content: `
                                    <h2>Product Rule and Quotient Rule</h2>
                                    <p class="lead">Essential rules for differentiating products and quotients of functions.</p>
                                    
                                    <h3>Product Rule</h3>
                                    <p>If \\(f(x) = u(x) \\cdot v(x)\\), then:</p>
                                    \\[f'(x) = u'(x)v(x) + u(x)v'(x)\\]
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Find \\(\\frac{d}{dx}[(x^2 + 1)(3x - 2)]\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Let \\(u = x^2 + 1\\) and \\(v = 3x - 2\\)</p>
                                            <p>\\(u' = 2x\\) and \\(v' = 3\\)</p>
                                            <p>\\(f'(x) = (2x)(3x - 2) + (x^2 + 1)(3)\\)</p>
                                            <p>\\(= 6x^2 - 4x + 3x^2 + 3 = 9x^2 - 4x + 3\\)</p>
                                        </div>
                                    </div>
                                    
                                    <h3>Quotient Rule</h3>
                                    <p>If \\(f(x) = \\frac{u(x)}{v(x)}\\), then:</p>
                                    \\[f'(x) = \\frac{u'(x)v(x) - u(x)v'(x)}{[v(x)]^2}\\]
                                `
                            },
                            'u3l2': {
                                id: 'u3l2',
                                title: 'Chain Rule',
                                content: `
                                    <h2>Chain Rule</h2>
                                    <p class="lead">The most important rule for differentiating composite functions.</p>
                                    
                                    <h3>Chain Rule Formula</h3>
                                    <p>If \\(f(x) = g(h(x))\\), then:</p>
                                    \\[f'(x) = g'(h(x)) \\cdot h'(x)\\]
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Find \\(\\frac{d}{dx}[(2x + 1)^5]\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Let \\(g(u) = u^5\\) and \\(h(x) = 2x + 1\\)</p>
                                            <p>\\(g'(u) = 5u^4\\) and \\(h'(x) = 2\\)</p>
                                            <p>\\(f'(x) = 5(2x + 1)^4 \\cdot 2 = 10(2x + 1)^4\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u3l3': {
                                id: 'u3l3',
                                title: 'Trigonometric Functions',
                                content: `
                                    <h2>Derivatives of Trigonometric Functions</h2>
                                    <p class="lead">Essential derivatives for trigonometric functions.</p>
                                    
                                    <h3>Basic Trigonometric Derivatives</h3>
                                    <ul>
                                        <li>\\(\\frac{d}{dx}[\\sin x] = \\cos x\\)</li>
                                        <li>\\(\\frac{d}{dx}[\\cos x] = -\\sin x\\)</li>
                                        <li>\\(\\frac{d}{dx}[\\tan x] = \\sec^2 x\\)</li>
                                        <li>\\(\\frac{d}{dx}[\\sec x] = \\sec x \\tan x\\)</li>
                                        <li>\\(\\frac{d}{dx}[\\csc x] = -\\csc x \\cot x\\)</li>
                                        <li>\\(\\frac{d}{dx}[\\cot x] = -\\csc^2 x\\)</li>
                                    </ul>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Find \\(\\frac{d}{dx}[\\sin(3x^2)]\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Using the chain rule:</p>
                                            <p>\\(\\frac{d}{dx}[\\sin(3x^2)] = \\cos(3x^2) \\cdot \\frac{d}{dx}[3x^2]\\)</p>
                                            <p>\\(= \\cos(3x^2) \\cdot 6x = 6x\\cos(3x^2)\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u3l4': {
                                id: 'u3l4',
                                title: 'Exponential Functions',
                                content: `
                                    <h2>Derivatives of Exponential Functions</h2>
                                    <p class="lead">Master differentiation of exponential and logarithmic functions.</p>
                                    
                                    <h3>Exponential Derivatives</h3>
                                    <ul>
                                        <li>\\(\\frac{d}{dx}[e^x] = e^x\\)</li>
                                        <li>\\(\\frac{d}{dx}[a^x] = a^x \\ln a\\)</li>
                                        <li>\\(\\frac{d}{dx}[e^{f(x)}] = e^{f(x)} \\cdot f'(x)\\)</li>
                                    </ul>
                                    
                                    <h3>Logarithmic Derivatives</h3>
                                    <ul>
                                        <li>\\(\\frac{d}{dx}[\\ln x] = \\frac{1}{x}\\)</li>
                                        <li>\\(\\frac{d}{dx}[\\log_a x] = \\frac{1}{x \\ln a}\\)</li>
                                    </ul>
                                `
                            },
                            'u3l5': {
                                id: 'u3l5',
                                title: 'Inverse Trigonometric Functions',
                                content: `
                                    <h2>Derivatives of Inverse Trigonometric Functions</h2>
                                    <p class="lead">Learn to differentiate inverse trig functions.</p>
                                    
                                    <h3>Inverse Trig Derivatives</h3>
                                    <ul>
                                        <li>\\(\\frac{d}{dx}[\\sin^{-1} x] = \\frac{1}{\\sqrt{1-x^2}}\\)</li>
                                        <li>\\(\\frac{d}{dx}[\\cos^{-1} x] = \\frac{-1}{\\sqrt{1-x^2}}\\)</li>
                                        <li>\\(\\frac{d}{dx}[\\tan^{-1} x] = \\frac{1}{1+x^2}\\)</li>
                                        <li>\\(\\frac{d}{dx}[\\sec^{-1} x] = \\frac{1}{|x|\\sqrt{x^2-1}}\\)</li>
                                    </ul>
                                `
                            },
                            'u3l6': {
                                id: 'u3l6',
                                title: 'Implicit Differentiation',
                                content: `
                                    <h2>Implicit Differentiation</h2>
                                    <p class="lead">Differentiate equations where y is not isolated.</p>
                                    
                                    <h3>Method</h3>
                                    <ol>
                                        <li>Differentiate both sides with respect to x</li>
                                        <li>Apply chain rule to terms involving y</li>
                                        <li>Collect terms with dy/dx</li>
                                        <li>Solve for dy/dx</li>
                                    </ol>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Find dy/dx for \\(x^2 + y^2 = 25\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Differentiate both sides:</p>
                                            <p>\\(2x + 2y\\frac{dy}{dx} = 0\\)</p>
                                            <p>Solve for dy/dx:</p>
                                            <p>\\(\\frac{dy}{dx} = -\\frac{x}{y}\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u3l7': {
                                id: 'u3l7',
                                title: 'Related Rates',
                                content: `
                                    <h2>Related Rates Problems</h2>
                                    <p class="lead">Apply differentiation to solve real-world rate problems.</p>
                                    
                                    <h3>Strategy</h3>
                                    <ol>
                                        <li>Identify variables and their rates</li>
                                        <li>Write an equation relating the variables</li>
                                        <li>Differentiate implicitly with respect to time</li>
                                        <li>Substitute known values and solve</li>
                                    </ol>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Balloon inflation</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p><strong>Problem:</strong> A spherical balloon's radius increases at 2 cm/s. How fast is the volume increasing when r = 6 cm?</p>
                                            <p><strong>Solution:</strong></p>
                                            <p>\\(V = \\frac{4}{3}\\pi r^3\\)</p>
                                            <p>\\(\\frac{dV}{dt} = 4\\pi r^2 \\frac{dr}{dt}\\)</p>
                                            <p>\\(\\frac{dV}{dt} = 4\\pi (6)^2 (2) = 288\\pi\\) cm³/s</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u3l8': {
                                id: 'u3l8',
                                title: 'Review and Complex Examples',
                                content: `
                                    <h2>Review and Complex Examples</h2>
                                    <p class="lead">Master advanced differentiation through complex problems.</p>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Challenge Problem</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p><strong>Find:</strong> \\(\\frac{d}{dx}\\left[\\frac{\\sin(x^2)}{e^{3x}}\\right]\\)</p>
                                            <p><strong>Solution using quotient rule:</strong></p>
                                            <p>\\(\\frac{d}{dx}\\left[\\frac{\\sin(x^2)}{e^{3x}}\\right] = \\frac{e^{3x} \\cdot 2x\\cos(x^2) - \\sin(x^2) \\cdot 3e^{3x}}{(e^{3x})^2}\\)</p>
                                            <p>\\(= \\frac{e^{3x}(2x\\cos(x^2) - 3\\sin(x^2))}{e^{6x}} = \\frac{2x\\cos(x^2) - 3\\sin(x^2)}{e^{3x}}\\)</p>
                                        </div>
                                    </div>
                                `
                            }
                        },
                        quiz: {
                            questions: [
                                {
                                    type: 'multiple-choice',
                                    question: 'What is the derivative of \\(x^5\\)?',
                                    options: ['\\(4x^4\\)', '\\(5x^4\\)', '\\(x^4\\)', '\\(6x^5\\)'],
                                    correct: 1,
                                    feedback: 'Using the power rule: \\(\\frac{d}{dx}x^5 = 5x^4\\)'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'Using the product rule, what is \\(\\frac{d}{dx}[x^2 \\sin x]\\)?',
                                    options: ['\\(2x \\cos x\\)', '\\(2x \\sin x + x^2 \\cos x\\)', '\\(x^2 \\cos x\\)', '\\(2x \\sin x\\)'],
                                    correct: 1,
                                    feedback: 'Product rule: \\((uv)\' = u\'v + uv\' = 2x \\sin x + x^2 \\cos x\\)'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'What is \\(\\frac{d}{dx}[\\sin(3x)]\\)?',
                                    options: ['\\(\\cos(3x)\\)', '\\(3\\cos(3x)\\)', '\\(-\\sin(3x)\\)', '\\(3\\sin(3x)\\)'],
                                    correct: 1,
                                    feedback: 'Using the chain rule: \\(\\frac{d}{dx}[\\sin(3x)] = \\cos(3x) \\cdot 3 = 3\\cos(3x)\\)'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'Using the quotient rule, what is \\(\\frac{d}{dx}\\left[\\frac{x}{x+1}\\right]\\)?',
                                    options: ['\\(\\frac{1}{x+1}\\)', '\\(\\frac{1}{(x+1)^2}\\)', '\\(\\frac{x}{(x+1)^2}\\)', '\\(\\frac{-1}{(x+1)^2}\\)'],
                                    correct: 1,
                                    feedback: 'Quotient rule: \\(\\frac{(x+1) \\cdot 1 - x \\cdot 1}{(x+1)^2} = \\frac{1}{(x+1)^2}\\)'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'What is \\(\\frac{d}{dx}[e^x]\\)?',
                                    options: ['\\(xe^{x-1}\\)', '\\(e^x\\)', '\\(e^x \\ln e\\)', '\\(\\frac{e^x}{x}\\)'],
                                    correct: 1,
                                    feedback: 'The derivative of \\(e^x\\) is simply \\(e^x\\)'
                                }
                            ]
                        }
                    },
                    4: {
                        id: 4,
                        title: 'Applications of Derivatives',
                        topics: [
                            'Critical points and local extrema',
                            'First and second derivative tests',
                            'Concavity and inflection points',
                            'Curve sketching and function analysis',
                            'Optimization problems',
                            'Mean Value Theorem',
                            'L\'Hôpital\'s Rule',
                            'Linear approximation and differentials'
                        ],
                        lessons: {
                            'u4l1': {
                                id: 'u4l1',
                                title: 'Critical Points and Extrema',
                                content: `
                                    <h2>Critical Points and Extrema</h2>
                                    <p class="lead">Find maximum and minimum values of functions using derivatives.</p>
                                    
                                    <h3>Critical Points</h3>
                                    <p>Critical points occur where \\(f'(x) = 0\\) or \\(f'(x)\\) is undefined.</p>
                                    
                                    <h3>Types of Extrema</h3>
                                    <ul>
                                        <li><strong>Local Maximum:</strong> \\(f(c) \\geq f(x)\\) for all x near c</li>
                                        <li><strong>Local Minimum:</strong> \\(f(c) \\leq f(x)\\) for all x near c</li>
                                        <li><strong>Global Extrema:</strong> Absolute max/min on entire domain</li>
                                    </ul>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Find critical points of \\(f(x) = x^3 - 3x^2 + 2\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>\\(f'(x) = 3x^2 - 6x = 3x(x - 2)\\)</p>
                                            <p>Setting \\(f'(x) = 0\\): \\(3x(x - 2) = 0\\)</p>
                                            <p>Critical points: \\(x = 0\\) and \\(x = 2\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u4l2': {
                                id: 'u4l2',
                                title: 'First Derivative Test',
                                content: `
                                    <h2>First Derivative Test</h2>
                                    <p class="lead">Classify critical points using the sign of the derivative.</p>
                                    
                                    <h3>Test Procedure</h3>
                                    <ol>
                                        <li>Find critical points where \\(f'(x) = 0\\) or undefined</li>
                                        <li>Test the sign of \\(f'(x)\\) on intervals around each critical point</li>
                                        <li>Classify based on sign changes</li>
                                    </ol>
                                    
                                    <h3>Classification</h3>
                                    <ul>
                                        <li>\\(f'(x)\\) changes from + to -: Local maximum</li>
                                        <li>\\(f'(x)\\) changes from - to +: Local minimum</li>
                                        <li>No sign change: Neither max nor min</li>
                                    </ul>
                                `
                            },
                            'u4l3': {
                                id: 'u4l3',
                                title: 'Second Derivative Test',
                                content: `
                                    <h2>Second Derivative Test</h2>
                                    <p class="lead">Use the second derivative to classify critical points efficiently.</p>
                                    
                                    <h3>Test Conditions</h3>
                                    <p>If \\(f'(c) = 0\\):</p>
                                    <ul>
                                        <li>If \\(f''(c) > 0\\): Local minimum at \\(x = c\\)</li>
                                        <li>If \\(f''(c) < 0\\): Local maximum at \\(x = c\\)</li>
                                        <li>If \\(f''(c) = 0\\): Test is inconclusive</li>
                                    </ul>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Classify critical points of \\(f(x) = x^4 - 4x^3\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>\\(f'(x) = 4x^3 - 12x^2 = 4x^2(x - 3)\\)</p>
                                            <p>Critical points: \\(x = 0, 3\\)</p>
                                            <p>\\(f''(x) = 12x^2 - 24x = 12x(x - 2)\\)</p>
                                            <p>\\(f''(0) = 0\\) (inconclusive), \\(f''(3) = 36 > 0\\) (local min)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u4l4': {
                                id: 'u4l4',
                                title: 'Concavity and Inflection Points',
                                content: `
                                    <h2>Concavity and Inflection Points</h2>
                                    <p class="lead">Analyze the curvature of functions using the second derivative.</p>
                                    
                                    <h3>Concavity</h3>
                                    <ul>
                                        <li><strong>Concave Up:</strong> \\(f''(x) > 0\\) (curve bends upward)</li>
                                        <li><strong>Concave Down:</strong> \\(f''(x) < 0\\) (curve bends downward)</li>
                                    </ul>
                                    
                                    <h3>Inflection Points</h3>
                                    <p>Points where concavity changes. Occur where \\(f''(x) = 0\\) or \\(f''(x)\\) is undefined, and concavity actually changes.</p>
                                `
                            },
                            'u4l5': {
                                id: 'u4l5',
                                title: 'Curve Sketching',
                                content: `
                                    <h2>Curve Sketching</h2>
                                    <p class="lead">Combine all derivative information to sketch complete function graphs.</p>
                                    
                                    <h3>Curve Sketching Checklist</h3>
                                    <ol>
                                        <li>Find domain and range</li>
                                        <li>Find x and y intercepts</li>
                                        <li>Find vertical and horizontal asymptotes</li>
                                        <li>Find critical points and classify them</li>
                                        <li>Find inflection points and concavity intervals</li>
                                        <li>Sketch the curve</li>
                                    </ol>
                                `
                            },
                            'u4l6': {
                                id: 'u4l6',
                                title: 'Optimization Problems',
                                content: `
                                    <h2>Optimization Problems</h2>
                                    <p class="lead">Solve real-world problems by finding maximum and minimum values.</p>
                                    
                                    <h3>Strategy</h3>
                                    <ol>
                                        <li>Identify the quantity to be optimized</li>
                                        <li>Express it as a function of one variable</li>
                                        <li>Find the domain of the function</li>
                                        <li>Find critical points</li>
                                        <li>Evaluate at critical points and endpoints</li>
                                        <li>Choose the optimal value</li>
                                    </ol>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Maximize rectangular area</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p><strong>Problem:</strong> Find the maximum area of a rectangle with perimeter 20.</p>
                                            <p>Let length = x, width = y. Then 2x + 2y = 20, so y = 10 - x</p>
                                            <p>Area = xy = x(10 - x) = 10x - x²</p>
                                            <p>A'(x) = 10 - 2x = 0 ⟹ x = 5</p>
                                            <p>Maximum area = 5 × 5 = 25 square units</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u4l7': {
                                id: 'u4l7',
                                title: 'Mean Value Theorem',
                                content: `
                                    <h2>Mean Value Theorem</h2>
                                    <p class="lead">A fundamental theorem connecting average and instantaneous rates of change.</p>
                                    
                                    <h3>Statement</h3>
                                    <p>If \\(f\\) is continuous on \\([a,b]\\) and differentiable on \\((a,b)\\), then there exists \\(c \\in (a,b)\\) such that:</p>
                                    \\[f'(c) = \\frac{f(b) - f(a)}{b - a}\\]
                                    
                                    <h3>Geometric Interpretation</h3>
                                    <p>The instantaneous rate of change at some point equals the average rate of change over the interval.</p>
                                `
                            },
                            'u4l8': {
                                id: 'u4l8',
                                title: 'L\'Hôpital\'s Rule',
                                content: `
                                    <h2>L'Hôpital's Rule</h2>
                                    <p class="lead">Evaluate indeterminate limits using derivatives.</p>
                                    
                                    <h3>Rule</h3>
                                    <p>If \\(\\lim_{x \\to a} \\frac{f(x)}{g(x)}\\) has form \\(\\frac{0}{0}\\) or \\(\\frac{\\infty}{\\infty}\\), then:</p>
                                    \\[\\lim_{x \\to a} \\frac{f(x)}{g(x)} = \\lim_{x \\to a} \\frac{f'(x)}{g'(x)}\\]
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: \\(\\lim_{x \\to 0} \\frac{\\sin x}{x}\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>This has form \\(\\frac{0}{0}\\), so apply L'Hôpital's rule:</p>
                                            <p>\\(\\lim_{x \\to 0} \\frac{\\sin x}{x} = \\lim_{x \\to 0} \\frac{\\cos x}{1} = 1\\)</p>
                                        </div>
                                    </div>
                                `
                            }
                        },
                        quiz: {
                            questions: [
                                {
                                    type: 'multiple-choice',
                                    question: 'Where do critical points occur?',
                                    options: ['Where \\(f(x) = 0\\)', 'Where \\(f\'(x) = 0\\) or undefined', 'At endpoints only', 'Where \\(f\'\'(x) = 0\\)'],
                                    correct: 1,
                                    feedback: 'Critical points are where the derivative is zero or undefined.'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'If \\(f\'(c) = 0\\) and \\(f\'\'(c) > 0\\), then at \\(x = c\\) there is a:',
                                    options: ['Local maximum', 'Local minimum', 'Inflection point', 'Cannot determine'],
                                    correct: 1,
                                    feedback: 'By the second derivative test, \\(f\'\'(c) > 0\\) indicates a local minimum.'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'A function is concave up when:',
                                    options: ['\\(f\'(x) > 0\\)', '\\(f\'(x) < 0\\)', '\\(f\'\'(x) > 0\\)', '\\(f\'\'(x) < 0\\)'],
                                    correct: 2,
                                    feedback: 'Concavity is determined by the sign of the second derivative.'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'The Mean Value Theorem guarantees that:',
                                    options: [
                                        'Every function has a maximum',
                                        'The average rate equals some instantaneous rate', 
                                        'All functions are differentiable',
                                        'Critical points exist'
                                    ],
                                    correct: 1,
                                    feedback: 'MVT states that average rate of change equals instantaneous rate at some point.'
                                },
                                {
                                    type: 'numeric',
                                    question: 'Find the critical points of \\(f(x) = x^3 - 6x^2 + 9x\\). Enter the smaller value.',
                                    answer: 1,
                                    tolerance: 0.1,
                                    feedback: 'f\'(x) = 3x² - 12x + 9 = 3(x² - 4x + 3) = 3(x-1)(x-3), so critical points are x = 1 and x = 3.'
                                }
                            ]
                        }
                    },
                    5: {
                        id: 5,
                        title: 'Integrals',
                        topics: [
                            'Antiderivatives and indefinite integrals',
                            'Basic integration rules',
                            'Riemann sums and definite integrals',
                            'Fundamental Theorem of Calculus',
                            'Properties of definite integrals',
                            'Net change theorem',
                            'Average value of a function'
                        ],
                        lessons: {
                            'u5l1': {
                                id: 'u5l1',
                                title: 'Introduction to Antiderivatives',
                                content: `
                                    <h2>Introduction to Antiderivatives</h2>
                                    <p class="lead">Learn to reverse the process of differentiation.</p>
                                    
                                    <h3>Definition</h3>
                                    <p>An antiderivative of \\(f(x)\\) is a function \\(F(x)\\) such that \\(F'(x) = f(x)\\).</p>
                                    
                                    <h3>Indefinite Integral</h3>
                                    <p>\\(\\int f(x) \\, dx = F(x) + C\\)</p>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Find \\(\\int 3x^2 \\, dx\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Using the power rule for integration:</p>
                                            <p>\\(\\int 3x^2 \\, dx = 3 \\cdot \\frac{x^3}{3} + C = x^3 + C\\)</p>
                                            <p>Check: \\(\\frac{d}{dx}[x^3 + C] = 3x^2\\) ✓</p>
                                        </div>
                                    </div>
                                    
                                    <h3>Basic Integration Rules</h3>
                                    <ul>
                                        <li>\\(\\int x^n \\, dx = \\frac{x^{n+1}}{n+1} + C\\) (n ≠ -1)</li>
                                        <li>\\(\\int k \\, dx = kx + C\\)</li>
                                        <li>\\(\\int [f(x) + g(x)] \\, dx = \\int f(x) \\, dx + \\int g(x) \\, dx\\)</li>
                                    </ul>
                                `
                            },
                            'u5l2': {
                                id: 'u5l2',
                                title: 'Basic Integration Rules',
                                content: `
                                    <h2>Basic Integration Rules</h2>
                                    <p class="lead">Master the fundamental rules of integration.</p>
                                    
                                    <h3>Power Rule for Integration</h3>
                                    <p>\\(\\int x^n \\, dx = \\frac{x^{n+1}}{n+1} + C\\) where \\(n \\neq -1\\)</p>
                                    
                                    <h3>Common Integrals</h3>
                                    <ul>
                                        <li>\\(\\int 1 \\, dx = x + C\\)</li>
                                        <li>\\(\\int \\frac{1}{x} \\, dx = \\ln|x| + C\\)</li>
                                        <li>\\(\\int e^x \\, dx = e^x + C\\)</li>
                                        <li>\\(\\int \\sin x \\, dx = -\\cos x + C\\)</li>
                                        <li>\\(\\int \\cos x \\, dx = \\sin x + C\\)</li>
                                    </ul>
                                `
                            },
                            'u5l3': {
                                id: 'u5l3',
                                title: 'Riemann Sums',
                                content: `
                                    <h2>Riemann Sums and Definite Integrals</h2>
                                    <p class="lead">Understand integrals as limits of approximating sums.</p>
                                    
                                    <h3>Riemann Sum</h3>
                                    <p>\\(\\sum_{i=1}^{n} f(x_i^*) \\Delta x\\) where \\(\\Delta x = \\frac{b-a}{n}\\)</p>
                                    
                                    <h3>Definite Integral</h3>
                                    <p>\\(\\int_a^b f(x) \\, dx = \\lim_{n \\to \\infty} \\sum_{i=1}^{n} f(x_i^*) \\Delta x\\)</p>
                                    
                                    <h3>Geometric Interpretation</h3>
                                    <p>The definite integral represents the net area between the curve and the x-axis.</p>
                                `
                            },
                            'u5l4': {
                                id: 'u5l4',
                                title: 'Fundamental Theorem of Calculus',
                                content: `
                                    <h2>Fundamental Theorem of Calculus</h2>
                                    <p class="lead">The bridge connecting derivatives and integrals.</p>
                                    
                                    <h3>Part I</h3>
                                    <p>If \\(f\\) is continuous on \\([a,b]\\) and \\(F(x) = \\int_a^x f(t) \\, dt\\), then \\(F'(x) = f(x)\\).</p>
                                    
                                    <h3>Part II</h3>
                                    <p>If \\(f\\) is continuous on \\([a,b]\\) and \\(F\\) is any antiderivative of \\(f\\), then:</p>
                                    \\[\\int_a^b f(x) \\, dx = F(b) - F(a)\\]
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Evaluate \\(\\int_1^4 x^2 \\, dx\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Find antiderivative: \\(F(x) = \\frac{x^3}{3}\\)</p>
                                            <p>Apply FTC Part II:</p>
                                            <p>\\(\\int_1^4 x^2 \\, dx = F(4) - F(1) = \\frac{64}{3} - \\frac{1}{3} = \\frac{63}{3} = 21\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u5l5': {
                                id: 'u5l5',
                                title: 'Properties of Definite Integrals',
                                content: `
                                    <h2>Properties of Definite Integrals</h2>
                                    <p class="lead">Important properties that simplify integral calculations.</p>
                                    
                                    <h3>Key Properties</h3>
                                    <ul>
                                        <li>\\(\\int_a^a f(x) \\, dx = 0\\)</li>
                                        <li>\\(\\int_a^b f(x) \\, dx = -\\int_b^a f(x) \\, dx\\)</li>
                                        <li>\\(\\int_a^b [f(x) + g(x)] \\, dx = \\int_a^b f(x) \\, dx + \\int_a^b g(x) \\, dx\\)</li>
                                        <li>\\(\\int_a^b kf(x) \\, dx = k\\int_a^b f(x) \\, dx\\)</li>
                                        <li>\\(\\int_a^c f(x) \\, dx = \\int_a^b f(x) \\, dx + \\int_b^c f(x) \\, dx\\)</li>
                                    </ul>
                                `
                            },
                            'u5l6': {
                                id: 'u5l6',
                                title: 'Net Change Theorem',
                                content: `
                                    <h2>Net Change Theorem</h2>
                                    <p class="lead">Connect integrals to real-world rate problems.</p>
                                    
                                    <h3>Theorem</h3>
                                    <p>If \\(F'(x) = f(x)\\), then:</p>
                                    \\[\\int_a^b f(x) \\, dx = F(b) - F(a)\\]
                                    
                                    <h3>Applications</h3>
                                    <ul>
                                        <li><strong>Displacement:</strong> \\(\\int_a^b v(t) \\, dt = s(b) - s(a)\\)</li>
                                        <li><strong>Total Change:</strong> \\(\\int_a^b f'(x) \\, dx = f(b) - f(a)\\)</li>
                                    </ul>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Distance traveled</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>If velocity is \\(v(t) = 2t + 1\\) m/s, find distance traveled from t = 0 to t = 3 seconds.</p>
                                            <p>\\(\\int_0^3 (2t + 1) \\, dt = [t^2 + t]_0^3 = (9 + 3) - (0) = 12\\) meters</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u5l7': {
                                id: 'u5l7',
                                title: 'Average Value of a Function',
                                content: `
                                    <h2>Average Value of a Function</h2>
                                    <p class="lead">Find the average height of a function over an interval.</p>
                                    
                                    <h3>Formula</h3>
                                    <p>The average value of \\(f\\) on \\([a,b]\\) is:</p>
                                    \\[f_{avg} = \\frac{1}{b-a} \\int_a^b f(x) \\, dx\\]
                                    
                                    <h3>Mean Value Theorem for Integrals</h3>
                                    <p>There exists \\(c \\in [a,b]\\) such that \\(f(c) = f_{avg}\\).</p>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Average value of \\(f(x) = x^2\\) on [0,2]</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>\\(f_{avg} = \\frac{1}{2-0} \\int_0^2 x^2 \\, dx\\)</p>
                                            <p>\\(= \\frac{1}{2} \\left[\\frac{x^3}{3}\\right]_0^2\\)</p>
                                            <p>\\(= \\frac{1}{2} \\cdot \\frac{8}{3} = \\frac{4}{3}\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u5l8': {
                                id: 'u5l8',
                                title: 'Integration Review and Applications',
                                content: `
                                    <h2>Integration Review and Applications</h2>
                                    <p class="lead">Consolidate your understanding of integration concepts.</p>
                                    
                                    <h3>Key Concepts</h3>
                                    <ul>
                                        <li>Antiderivatives reverse differentiation</li>
                                        <li>Definite integrals represent net area</li>
                                        <li>Fundamental Theorem connects derivatives and integrals</li>
                                        <li>Integration has many real-world applications</li>
                                    </ul>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Summary Problem: Area between curves</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Find the area between \\(y = x^2\\) and \\(y = 2x\\) from x = 0 to x = 2.</p>
                                            <p>Area = \\(\\int_0^2 |2x - x^2| \\, dx\\)</p>
                                            <p>Since \\(2x \\geq x^2\\) on [0,2]:</p>
                                            <p>Area = \\(\\int_0^2 (2x - x^2) \\, dx = [x^2 - \\frac{x^3}{3}]_0^2 = 4 - \\frac{8}{3} = \\frac{4}{3}\\)</p>
                                        </div>
                                    </div>
                                `
                            }
                        },
                        quiz: {
                            questions: [
                                {
                                    type: 'multiple-choice',
                                    question: 'What is \\(\\int x^2 \\, dx\\)?',
                                    options: ['\\(2x + C\\)', '\\(\\frac{x^3}{3} + C\\)', '\\(x^3 + C\\)', '\\(\\frac{x^2}{2} + C\\)'],
                                    correct: 1,
                                    feedback: 'Using the power rule for integration: \\(\\int x^2 \\, dx = \\frac{x^3}{3} + C\\)'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'What does the Fundamental Theorem of Calculus (Part II) state?',
                                    options: [
                                        'Derivatives and integrals are unrelated',
                                        'Every function has an antiderivative',
                                        '\\(\\int_a^b f(x) \\, dx = F(b) - F(a)\\) where F\' = f',
                                        'Integrals always equal zero'
                                    ],
                                    correct: 2,
                                    feedback: 'FTC Part II allows us to evaluate definite integrals using antiderivatives.'
                                },
                                {
                                    type: 'numeric',
                                    question: 'Evaluate \\(\\int_0^3 2x \\, dx\\)',
                                    answer: 9,
                                    tolerance: 0.1,
                                    feedback: '\\(\\int_0^3 2x \\, dx = [x^2]_0^3 = 9 - 0 = 9\\)'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'The average value of \\(f(x) = 4\\) on the interval [1,5] is:',
                                    options: ['2', '4', '8', '16'],
                                    correct: 1,
                                    feedback: 'The average value of a constant function is the constant itself.'
                                },
                                {
                                    type: 'numeric',
                                    question: 'If \\(F(x) = \\int_2^x t^2 \\, dt\\), find \\(F\'(3)\\)',
                                    answer: 9,
                                    tolerance: 0.1,
                                    feedback: 'By FTC Part I, \\(F\'(x) = x^2\\), so \\(F\'(3) = 9\\)'
                                }
                            ]
                        }
                    },
                    6: {
                        id: 6,
                        title: 'Integration Techniques',
                        topics: [
                            'Integration by substitution (u-substitution)',
                            'Integration by parts',
                            'Trigonometric integrals',
                            'Trigonometric substitution',
                            'Partial fractions',
                            'Improper integrals',
                            'Numerical integration methods'
                        ],
                        lessons: {
                            'u6l1': {
                                id: 'u6l1',
                                title: 'U-Substitution',
                                content: `
                                    <h2>U-Substitution</h2>
                                    <p class="lead">The chain rule in reverse - a powerful integration technique.</p>
                                    
                                    <h3>When to Use U-Substitution</h3>
                                    <p>Look for a function and its derivative in the integrand.</p>
                                    
                                    <h3>Steps</h3>
                                    <ol>
                                        <li>Choose \\(u\\) (usually the "inside" function)</li>
                                        <li>Find \\(du\\)</li>
                                        <li>Substitute everything in terms of \\(u\\)</li>
                                        <li>Integrate with respect to \\(u\\)</li>
                                        <li>Back-substitute to get answer in terms of \\(x\\)</li>
                                    </ol>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: \\(\\int 2x(x^2 + 1)^5 \\, dx\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Let \\(u = x^2 + 1\\), then \\(du = 2x \\, dx\\)</p>
                                            <p>\\(\\int 2x(x^2 + 1)^5 \\, dx = \\int u^5 \\, du\\)</p>
                                            <p>\\(= \\frac{u^6}{6} + C = \\frac{(x^2 + 1)^6}{6} + C\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u6l2': {
                                id: 'u6l2',
                                title: 'Integration by Parts',
                                content: `
                                    <h2>Integration by Parts</h2>
                                    <p class="lead">The product rule in reverse.</p>
                                    
                                    <h3>Formula</h3>
                                    <p>\\(\\int u \\, dv = uv - \\int v \\, du\\)</p>
                                    
                                    <h3>Strategy (LIATE)</h3>
                                    <p>Choose \\(u\\) in this order of preference:</p>
                                    <ul>
                                        <li><strong>L</strong>ogarithmic functions</li>
                                        <li><strong>I</strong>nverse trig functions</li>
                                        <li><strong>A</strong>lgebraic functions (polynomials)</li>
                                        <li><strong>T</strong>rigonometric functions</li>
                                        <li><strong>E</strong>xponential functions</li>
                                    </ul>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: \\(\\int x e^x \\, dx\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Let \\(u = x\\) (algebraic) and \\(dv = e^x \\, dx\\)</p>
                                            <p>Then \\(du = dx\\) and \\(v = e^x\\)</p>
                                            <p>\\(\\int x e^x \\, dx = xe^x - \\int e^x \\, dx\\)</p>
                                            <p>\\(= xe^x - e^x + C = e^x(x - 1) + C\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u6l3': {
                                id: 'u6l3',
                                title: 'Trigonometric Integrals',
                                content: `
                                    <h2>Trigonometric Integrals</h2>
                                    <p class="lead">Techniques for integrating powers of sine and cosine.</p>
                                    
                                    <h3>Basic Trig Integrals</h3>
                                    <ul>
                                        <li>\\(\\int \\sin x \\, dx = -\\cos x + C\\)</li>
                                        <li>\\(\\int \\cos x \\, dx = \\sin x + C\\)</li>
                                        <li>\\(\\int \\sec^2 x \\, dx = \\tan x + C\\)</li>
                                        <li>\\(\\int \\sec x \\tan x \\, dx = \\sec x + C\\)</li>
                                    </ul>
                                    
                                    <h3>Strategies</h3>
                                    <ul>
                                        <li>Odd powers: Save one factor, convert rest using identities</li>
                                        <li>Even powers: Use power-reduction formulas</li>
                                        <li>Powers of tangent and secant: Special techniques</li>
                                    </ul>
                                `
                            },
                            'u6l4': {
                                id: 'u6l4',
                                title: 'Trigonometric Substitution',
                                content: `
                                    <h2>Trigonometric Substitution</h2>
                                    <p class="lead">Handle integrals involving \\(\\sqrt{a^2 - x^2}\\), \\(\\sqrt{a^2 + x^2}\\), and \\(\\sqrt{x^2 - a^2}\\).</p>
                                    
                                    <h3>Three Cases</h3>
                                    <ul>
                                        <li>\\(\\sqrt{a^2 - x^2}\\): Use \\(x = a\\sin\\theta\\)</li>
                                        <li>\\(\\sqrt{a^2 + x^2}\\): Use \\(x = a\\tan\\theta\\)</li>
                                        <li>\\(\\sqrt{x^2 - a^2}\\): Use \\(x = a\\sec\\theta\\)</li>
                                    </ul>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: \\(\\int \\frac{1}{\\sqrt{4 - x^2}} \\, dx\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Let \\(x = 2\\sin\\theta\\), \\(dx = 2\\cos\\theta \\, d\\theta\\)</p>
                                            <p>\\(\\sqrt{4 - x^2} = \\sqrt{4 - 4\\sin^2\\theta} = 2\\cos\\theta\\)</p>
                                            <p>\\(\\int \\frac{1}{\\sqrt{4 - x^2}} \\, dx = \\int \\frac{2\\cos\\theta}{2\\cos\\theta} \\, d\\theta = \\int d\\theta = \\theta + C\\)</p>
                                            <p>\\(= \\sin^{-1}(x/2) + C\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u6l5': {
                                id: 'u6l5',
                                title: 'Partial Fractions',
                                content: `
                                    <h2>Partial Fractions</h2>
                                    <p class="lead">Decompose rational functions into simpler fractions.</p>
                                    
                                    <h3>When to Use</h3>
                                    <p>For \\(\\int \\frac{P(x)}{Q(x)} \\, dx\\) where degree of \\(P < \\) degree of \\(Q\\).</p>
                                    
                                    <h3>Method</h3>
                                    <ol>
                                        <li>Factor the denominator \\(Q(x)\\)</li>
                                        <li>Write partial fraction decomposition</li>
                                        <li>Solve for unknown constants</li>
                                        <li>Integrate each term</li>
                                    </ol>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: \\(\\int \\frac{1}{x^2 - 1} \\, dx\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>\\(\\frac{1}{x^2 - 1} = \\frac{1}{(x-1)(x+1)} = \\frac{A}{x-1} + \\frac{B}{x+1}\\)</p>
                                            <p>Solving: \\(1 = A(x+1) + B(x-1)\\)</p>
                                            <p>\\(A = \\frac{1}{2}, B = -\\frac{1}{2}\\)</p>
                                            <p>\\(\\int \\frac{1}{x^2 - 1} \\, dx = \\frac{1}{2}\\ln|x-1| - \\frac{1}{2}\\ln|x+1| + C\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u6l6': {
                                id: 'u6l6',
                                title: 'Improper Integrals',
                                content: `
                                    <h2>Improper Integrals</h2>
                                    <p class="lead">Integrals with infinite limits or discontinuous integrands.</p>
                                    
                                    <h3>Type I: Infinite Limits</h3>
                                    <p>\\(\\int_a^\\infty f(x) \\, dx = \\lim_{t \\to \\infty} \\int_a^t f(x) \\, dx\\)</p>
                                    
                                    <h3>Type II: Discontinuous Integrand</h3>
                                    <p>\\(\\int_a^b f(x) \\, dx = \\lim_{t \\to c^-} \\int_a^t f(x) \\, dx\\) (if discontinuous at \\(x = c\\))</p>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: \\(\\int_1^\\infty \\frac{1}{x^2} \\, dx\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>\\(\\int_1^\\infty \\frac{1}{x^2} \\, dx = \\lim_{t \\to \\infty} \\int_1^t x^{-2} \\, dx\\)</p>
                                            <p>\\(= \\lim_{t \\to \\infty} [-x^{-1}]_1^t\\)</p>
                                            <p>\\(= \\lim_{t \\to \\infty} (-\\frac{1}{t} + 1) = 1\\)</p>
                                            <p>This integral converges to 1.</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u6l7': {
                                id: 'u6l7',
                                title: 'Numerical Integration',
                                content: `
                                    <h2>Numerical Integration Methods</h2>
                                    <p class="lead">Approximate definite integrals when exact methods fail.</p>
                                    
                                    <h3>Trapezoidal Rule</h3>
                                    <p>\\(\\int_a^b f(x) \\, dx \\approx \\frac{\\Delta x}{2}[f(x_0) + 2f(x_1) + ... + 2f(x_{n-1}) + f(x_n)]\\)</p>
                                    
                                    <h3>Simpson's Rule</h3>
                                    <p>\\(\\int_a^b f(x) \\, dx \\approx \\frac{\\Delta x}{3}[f(x_0) + 4f(x_1) + 2f(x_2) + 4f(x_3) + ... + f(x_n)]\\)</p>
                                    
                                    <h3>When to Use</h3>
                                    <ul>
                                        <li>No elementary antiderivative exists</li>
                                        <li>Function is only known at discrete points</li>
                                        <li>Quick approximation needed</li>
                                    </ul>
                                `
                            },
                            'u6l8': {
                                id: 'u6l8',
                                title: 'Integration Techniques Review',
                                content: `
                                    <h2>Integration Techniques Review</h2>
                                    <p class="lead">Master the art of choosing the right technique.</p>
                                    
                                    <h3>Decision Tree</h3>
                                    <ol>
                                        <li><strong>Basic forms?</strong> Use standard formulas</li>
                                        <li><strong>Product of functions?</strong> Try u-substitution or integration by parts</li>
                                        <li><strong>Rational function?</strong> Use partial fractions</li>
                                        <li><strong>Radical expressions?</strong> Try trig substitution</li>
                                        <li><strong>Trig functions?</strong> Use trig identities and techniques</li>
                                        <li><strong>Can't be done exactly?</strong> Use numerical methods</li>
                                    </ol>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Challenge Problem</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Evaluate: \\(\\int \\frac{x^2}{\\sqrt{x^2 + 4}} \\, dx\\)</p>
                                            <p>This requires trigonometric substitution with \\(x = 2\\tan\\theta\\).</p>
                                            <p>Final answer: \\(\\frac{x\\sqrt{x^2 + 4}}{2} - 2\\ln(x + \\sqrt{x^2 + 4}) + C\\)</p>
                                        </div>
                                    </div>
                                `
                            }
                        },
                        quiz: {
                            questions: [
                                {
                                    type: 'multiple-choice',
                                    question: 'What substitution should be used for \\(\\int 2x e^{x^2} \\, dx\\)?',
                                    options: ['\\(u = 2x\\)', '\\(u = e^{x^2}\\)', '\\(u = x^2\\)', '\\(u = 2x^2\\)'],
                                    correct: 2,
                                    feedback: 'Let \\(u = x^2\\), then \\(du = 2x \\, dx\\)'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'For integration by parts \\(\\int u \\, dv = uv - \\int v \\, du\\), which should be \\(u\\) in \\(\\int x \\ln x \\, dx\\)?',
                                    options: ['\\(x\\)', '\\(\\ln x\\)', 'Either one', 'Neither'],
                                    correct: 1,
                                    feedback: 'Choose \\(u = \\ln x\\) (logarithmic functions have priority in LIATE)'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'For \\(\\int \\frac{1}{\\sqrt{9 - x^2}} \\, dx\\), what substitution should be used?',
                                    options: ['\\(x = 3\\sin\\theta\\)', '\\(x = 3\\tan\\theta\\)', '\\(x = 3\\sec\\theta\\)', 'No substitution needed'],
                                    correct: 0,
                                    feedback: 'For \\(\\sqrt{a^2 - x^2}\\), use \\(x = a\\sin\\theta\\)'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'The partial fraction decomposition of \\(\\frac{1}{(x-1)(x+2)}\\) is:',
                                    options: [
                                        '\\(\\frac{A}{x-1} + \\frac{B}{x+2}\\)',
                                        '\\(\\frac{A}{(x-1)^2} + \\frac{B}{x+2}\\)',
                                        '\\(\\frac{Ax + B}{(x-1)(x+2)}\\)',
                                        'Cannot be decomposed'
                                    ],
                                    correct: 0,
                                    feedback: 'Linear distinct factors give \\(\\frac{A}{x-1} + \\frac{B}{x+2}\\)'
                                },
                                {
                                    type: 'numeric',
                                    question: 'Evaluate \\(\\int_1^\\infty \\frac{1}{x^3} \\, dx\\)',
                                    answer: 0.5,
                                    tolerance: 0.01,
                                    feedback: 'This improper integral equals \\(\\frac{1}{2}\\)'
                                }
                            ]
                        }
                    },
                    7: {
                        id: 7,
                        title: 'Applications of Integration',
                        topics: [
                            'Area between curves',
                            'Volumes using disk and washer methods',
                            'Volumes using cylindrical shells',
                            'Arc length and surface area',
                            'Work and fluid pressure',
                            'Center of mass and moments',
                            'Differential equations and slope fields'
                        ],
                        lessons: {
                            'u7l1': {
                                id: 'u7l1',
                                title: 'Area Between Curves',
                                content: `
                                    <h2>Area Between Curves</h2>
                                    <p class="lead">Use integrals to find areas between functions.</p>
                                    
                                    <h3>Formula</h3>
                                    <p>Area = \\(\\int_a^b |f(x) - g(x)| \\, dx\\)</p>
                                    
                                    <h3>Steps</h3>
                                    <ol>
                                        <li>Find intersection points</li>
                                        <li>Determine which function is on top</li>
                                        <li>Set up the integral</li>
                                        <li>Evaluate</li>
                                    </ol>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Area between \\(y = x^2\\) and \\(y = 4\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Find intersections: \\(x^2 = 4 \\Rightarrow x = \\pm 2\\)</p>
                                            <p>Since \\(4 > x^2\\) on [-2, 2]:</p>
                                            <p>Area = \\(\\int_{-2}^{2} (4 - x^2) \\, dx\\)</p>
                                            <p>\\(= [4x - \\frac{x^3}{3}]_{-2}^{2} = \\frac{32}{3}\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u7l2': {
                                id: 'u7l2',
                                title: 'Disk and Washer Method',
                                content: `
                                    <h2>Volumes: Disk and Washer Method</h2>
                                    <p class="lead">Find volumes of solids of revolution by slicing.</p>
                                    
                                    <h3>Disk Method</h3>
                                    <p>Volume = \\(\\pi \\int_a^b [R(x)]^2 \\, dx\\)</p>
                                    <p>where R(x) is the radius function</p>
                                    
                                    <h3>Washer Method</h3>
                                    <p>Volume = \\(\\pi \\int_a^b ([R(x)]^2 - [r(x)]^2) \\, dx\\)</p>
                                    <p>where R(x) is outer radius, r(x) is inner radius</p>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Volume when \\(y = x^2\\) is revolved around x-axis</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>From x = 0 to x = 2, radius R(x) = x²</p>
                                            <p>Volume = \\(\\pi \\int_0^2 (x^2)^2 \\, dx = \\pi \\int_0^2 x^4 \\, dx\\)</p>
                                            <p>\\(= \\pi [\\frac{x^5}{5}]_0^2 = \\frac{32\\pi}{5}\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u7l3': {
                                id: 'u7l3',
                                title: 'Cylindrical Shell Method',
                                content: `
                                    <h2>Volumes: Cylindrical Shell Method</h2>
                                    <p class="lead">Alternative method for volumes of revolution.</p>
                                    
                                    <h3>Formula</h3>
                                    <p>Volume = \\(2\\pi \\int_a^b x f(x) \\, dx\\)</p>
                                    <p>where x is the distance from axis and f(x) is the height</p>
                                    
                                    <h3>When to Use</h3>
                                    <ul>
                                        <li>Revolving around y-axis when function is in terms of x</li>
                                        <li>When washers would be more complicated</li>
                                        <li>When the "other variable" is easier to integrate</li>
                                    </ul>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Volume when \\(y = x^2\\) is revolved around y-axis</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>From x = 0 to x = 2, using shell method:</p>
                                            <p>Volume = \\(2\\pi \\int_0^2 x \\cdot x^2 \\, dx = 2\\pi \\int_0^2 x^3 \\, dx\\)</p>
                                            <p>\\(= 2\\pi [\\frac{x^4}{4}]_0^2 = 2\\pi \\cdot 4 = 8\\pi\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u7l4': {
                                id: 'u7l4',
                                title: 'Arc Length and Surface Area',
                                content: `
                                    <h2>Arc Length and Surface Area</h2>
                                    <p class="lead">Find lengths of curves and surface areas of revolution.</p>
                                    
                                    <h3>Arc Length</h3>
                                    <p>For \\(y = f(x)\\) from \\(x = a\\) to \\(x = b\\):</p>
                                    <p>\\(L = \\int_a^b \\sqrt{1 + [f'(x)]^2} \\, dx\\)</p>
                                    
                                    <h3>Surface Area of Revolution</h3>
                                    <p>Around x-axis: \\(S = 2\\pi \\int_a^b f(x)\\sqrt{1 + [f'(x)]^2} \\, dx\\)</p>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Arc length of \\(y = x^{3/2}\\) from x = 0 to x = 4</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>\\(f'(x) = \\frac{3}{2}x^{1/2}\\)</p>
                                            <p>\\(L = \\int_0^4 \\sqrt{1 + (\\frac{3}{2}x^{1/2})^2} \\, dx\\)</p>
                                            <p>\\(= \\int_0^4 \\sqrt{1 + \\frac{9x}{4}} \\, dx\\)</p>
                                            <p>Using substitution, this evaluates to \\(\\frac{8}{27}(10\\sqrt{10} - 1)\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u7l5': {
                                id: 'u7l5',
                                title: 'Work and Force',
                                content: `
                                    <h2>Work and Force Applications</h2>
                                    <p class="lead">Apply integration to physics problems involving work and force.</p>
                                    
                                    <h3>Work Formula</h3>
                                    <p>If force varies: \\(W = \\int_a^b F(x) \\, dx\\)</p>
                                    
                                    <h3>Common Applications</h3>
                                    <ul>
                                        <li>Stretching springs: \\(F = kx\\) (Hooke's Law)</li>
                                        <li>Lifting fluids: \\(F = \\rho g \\cdot \\text{volume}\\)</li>
                                        <li>Pumping water: Consider distance lifted</li>
                                    </ul>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Work to stretch spring</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Spring with \\(k = 20\\) N/m stretched from 0 to 0.5 m:</p>
                                            <p>\\(F(x) = 20x\\) newtons</p>
                                            <p>\\(W = \\int_0^{0.5} 20x \\, dx = 20[\\frac{x^2}{2}]_0^{0.5}\\)</p>
                                            <p>\\(= 10(0.25) = 2.5\\) joules</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u7l6': {
                                id: 'u7l6',
                                title: 'Fluid Pressure and Force',
                                content: `
                                    <h2>Fluid Pressure and Force</h2>
                                    <p class="lead">Calculate forces exerted by fluids on submerged objects.</p>
                                    
                                    <h3>Pressure Formula</h3>
                                    <p>Pressure at depth h: \\(P = \\rho g h\\)</p>
                                    <p>where \\(\\rho\\) is fluid density, g is gravity</p>
                                    
                                    <h3>Force on Submerged Surface</h3>
                                    <p>\\(F = \\int_a^b \\rho g h(y) w(y) \\, dy\\)</p>
                                    <p>where h(y) is depth and w(y) is width at height y</p>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Force on rectangular dam</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Vertical rectangular dam, 4m wide, 6m tall, water to top:</p>
                                            <p>At depth y from surface: pressure = \\(1000 \\cdot 9.8 \\cdot y\\)</p>
                                            <p>\\(F = \\int_0^6 1000 \\cdot 9.8 \\cdot y \\cdot 4 \\, dy\\)</p>
                                            <p>\\(= 39200 \\int_0^6 y \\, dy = 39200 \\cdot 18 = 705,600\\) N</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u7l7': {
                                id: 'u7l7',
                                title: 'Center of Mass and Moments',
                                content: `
                                    <h2>Center of Mass and Moments</h2>
                                    <p class="lead">Find the balance point of regions and objects.</p>
                                    
                                    <h3>Moments and Center of Mass</h3>
                                    <p>For region between y = f(x) and x-axis from a to b:</p>
                                    <ul>
                                        <li>Mass: \\(m = \\rho \\int_a^b f(x) \\, dx\\)</li>
                                        <li>First moment about y-axis: \\(M_y = \\rho \\int_a^b x f(x) \\, dx\\)</li>
                                        <li>First moment about x-axis: \\(M_x = \\rho \\int_a^b \\frac{[f(x)]^2}{2} \\, dx\\)</li>
                                        <li>Center: \\((\\bar{x}, \\bar{y}) = (\\frac{M_y}{m}, \\frac{M_x}{m})\\)</li>
                                    </ul>
                                `
                            },
                            'u7l8': {
                                id: 'u7l8',
                                title: 'Integration Applications Review',
                                content: `
                                    <h2>Integration Applications Review</h2>
                                    <p class="lead">Master the diverse applications of integration.</p>
                                    
                                    <h3>Key Applications</h3>
                                    <ul>
                                        <li>Area between curves</li>
                                        <li>Volumes of revolution (disks, washers, shells)</li>
                                        <li>Arc length and surface area</li>
                                        <li>Work and energy</li>
                                        <li>Fluid force and pressure</li>
                                        <li>Center of mass and moments</li>
                                    </ul>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Summary: Choosing the right method</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p><strong>For volumes:</strong></p>
                                            <ul>
                                                <li>Use disks/washers when slicing perpendicular to axis</li>
                                                <li>Use shells when slicing parallel to axis</li>
                                                <li>Choose method that gives simpler integrals</li>
                                            </ul>
                                            <p><strong>For applications:</strong></p>
                                            <ul>
                                                <li>Identify what varies and set up integral accordingly</li>
                                                <li>Include all relevant physical constants (density, gravity, etc.)</li>
                                                <li>Check units and reasonableness of answer</li>
                                            </ul>
                                        </div>
                                    </div>
                                `
                            }
                        },
                        quiz: {
                            questions: [
                                {
                                    type: 'multiple-choice',
                                    question: 'To find area between \\(y = x^2\\) and \\(y = x\\), what integral do we use?',
                                    options: ['\\(\\int_0^1 (x^2 - x) \\, dx\\)', '\\(\\int_0^1 (x - x^2) \\, dx\\)', '\\(\\int_0^1 x^2 \\, dx\\)', '\\(\\int_0^1 x \\, dx\\)'],
                                    correct: 1,
                                    feedback: 'Since \\(x > x^2\\) on \\([0,1]\\), we use \\(\\int_0^1 (x - x^2) \\, dx\\)'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'When revolving \\(y = f(x)\\) around the x-axis using the disk method, the volume is:',
                                    options: [
                                        '\\(\\pi \\int_a^b f(x) \\, dx\\)',
                                        '\\(\\pi \\int_a^b [f(x)]^2 \\, dx\\)',
                                        '\\(2\\pi \\int_a^b x f(x) \\, dx\\)',
                                        '\\(\\int_a^b \\pi [f(x)]^2 \\, dx\\)'
                                    ],
                                    correct: 1,
                                    feedback: 'Disk method: \\(V = \\pi \\int_a^b [f(x)]^2 \\, dx\\)'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'The shell method formula for revolving around the y-axis is:',
                                    options: [
                                        '\\(\\pi \\int_a^b [f(x)]^2 \\, dx\\)',
                                        '\\(2\\pi \\int_a^b f(x) \\, dx\\)',
                                        '\\(2\\pi \\int_a^b x f(x) \\, dx\\)',
                                        '\\(\\pi \\int_a^b x^2 f(x) \\, dx\\)'
                                    ],
                                    correct: 2,
                                    feedback: 'Shell method: \\(V = 2\\pi \\int_a^b x f(x) \\, dx\\) (radius × height)'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'The arc length of \\(y = f(x)\\) from \\(x = a\\) to \\(x = b\\) is:',
                                    options: [
                                        '\\(\\int_a^b f\'(x) \\, dx\\)',
                                        '\\(\\int_a^b \\sqrt{f\'(x)} \\, dx\\)',
                                        '\\(\\int_a^b \\sqrt{1 + [f\'(x)]^2} \\, dx\\)',
                                        '\\(\\int_a^b (1 + [f\'(x)]^2) \\, dx\\)'
                                    ],
                                    correct: 2,
                                    feedback: 'Arc length formula: \\(L = \\int_a^b \\sqrt{1 + [f\'(x)]^2} \\, dx\\)'
                                },
                                {
                                    type: 'numeric',
                                    question: 'Find the area between \\(y = x\\) and \\(y = x^2\\) from x = 0 to x = 1.',
                                    answer: 0.1667,
                                    tolerance: 0.01,
                                    feedback: 'Area = \\(\\int_0^1 (x - x^2) \\, dx = [\\frac{x^2}{2} - \\frac{x^3}{3}]_0^1 = \\frac{1}{6}\\)'
                                }
                            ]
                        }
                    },
                    8: {
                        id: 8,
                        title: 'Differential Equations',
                        topics: [
                            'Slope fields and Euler\'s method',
                            'Separable differential equations',
                            'Exponential growth and decay models',
                            'Logistic growth models',
                            'Newton\'s law of cooling',
                            'Related rates applications',
                            'Modeling with differential equations'
                        ],
                        lessons: {
                            'u8l1': {
                                id: 'u8l1',
                                title: 'Introduction to Differential Equations',
                                content: `
                                    <h2>Introduction to Differential Equations</h2>
                                    <p class="lead">Equations involving derivatives and their applications.</p>
                                    
                                    <h3>What is a Differential Equation?</h3>
                                    <p>An equation that relates a function to its derivatives.</p>
                                    
                                    <h3>Examples</h3>
                                    <ul>
                                        <li>\\(\\frac{dy}{dx} = 2x\\) (first order)</li>
                                        <li>\\(\\frac{d^2y}{dx^2} + y = 0\\) (second order)</li>
                                        <li>\\(\\frac{dy}{dt} = ky\\) (exponential growth/decay)</li>
                                    </ul>
                                    
                                    <h3>Types</h3>
                                    <ul>
                                        <li><strong>Order:</strong> Highest derivative present</li>
                                        <li><strong>Linear:</strong> No products of y and its derivatives</li>
                                        <li><strong>Separable:</strong> Can be written as \\(g(y)dy = h(x)dx\\)</li>
                                    </ul>
                                `
                            },
                            'u8l2': {
                                id: 'u8l2',
                                title: 'Slope Fields',
                                content: `
                                    <h2>Slope Fields and Direction Fields</h2>
                                    <p class="lead">Visualize solutions to differential equations.</p>
                                    
                                    <h3>What are Slope Fields?</h3>
                                    <p>Graphical representation showing the slope \\(\\frac{dy}{dx}\\) at many points in the xy-plane.</p>
                                    
                                    <h3>How to Draw</h3>
                                    <ol>
                                        <li>Choose grid points (x, y)</li>
                                        <li>Calculate \\(\\frac{dy}{dx}\\) at each point using the DE</li>
                                        <li>Draw short line segments with that slope</li>
                                        <li>Solution curves follow the field</li>
                                    </ol>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: \\(\\frac{dy}{dx} = x + y\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>At point (0, 0): slope = 0 + 0 = 0</p>
                                            <p>At point (1, 1): slope = 1 + 1 = 2</p>
                                            <p>At point (-1, 1): slope = -1 + 1 = 0</p>
                                            <p>Draw horizontal line at (0,0) and (-1,1), steep line at (1,1)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u8l3': {
                                id: 'u8l3',
                                title: 'Euler\'s Method',
                                content: `
                                    <h2>Euler's Method</h2>
                                    <p class="lead">Numerical approximation for solutions to differential equations.</p>
                                    
                                    <h3>The Method</h3>
                                    <p>Given \\(\\frac{dy}{dx} = f(x, y)\\) with \\(y(x_0) = y_0\\):</p>
                                    <ol>
                                        <li>Choose step size \\(h\\)</li>
                                        <li>\\(x_{n+1} = x_n + h\\)</li>
                                        <li>\\(y_{n+1} = y_n + h \\cdot f(x_n, y_n)\\)</li>
                                    </ol>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: \\(\\frac{dy}{dx} = y\\), \\(y(0) = 1\\), \\(h = 0.1\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>\\((x_0, y_0) = (0, 1)\\)</p>
                                            <p>\\(y_1 = 1 + 0.1(1) = 1.1\\) at \\(x_1 = 0.1\\)</p>
                                            <p>\\(y_2 = 1.1 + 0.1(1.1) = 1.21\\) at \\(x_2 = 0.2\\)</p>
                                            <p>Exact solution: \\(y = e^x\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u8l4': {
                                id: 'u8l4',
                                title: 'Separable Differential Equations',
                                content: `
                                    <h2>Separable Differential Equations</h2>
                                    <p class="lead">Solve DEs by separating variables.</p>
                                    
                                    <h3>Form</h3>
                                    <p>\\(\\frac{dy}{dx} = g(x)h(y)\\)</p>
                                    
                                    <h3>Method</h3>
                                    <ol>
                                        <li>Separate: \\(\\frac{dy}{h(y)} = g(x)dx\\)</li>
                                        <li>Integrate both sides</li>
                                        <li>Solve for y (if possible)</li>
                                        <li>Apply initial conditions</li>
                                    </ol>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: \\(\\frac{dy}{dx} = xy\\)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Separate: \\(\\frac{dy}{y} = x \\, dx\\)</p>
                                            <p>Integrate: \\(\\ln|y| = \\frac{x^2}{2} + C\\)</p>
                                            <p>Solve: \\(y = Ae^{x^2/2}\\) where \\(A = \\pm e^C\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u8l5': {
                                id: 'u8l5',
                                title: 'Exponential Growth and Decay',
                                content: `
                                    <h2>Exponential Growth and Decay Models</h2>
                                    <p class="lead">Model natural phenomena with exponential functions.</p>
                                    
                                    <h3>The Model</h3>
                                    <p>\\(\\frac{dP}{dt} = kP\\) where k > 0 (growth) or k < 0 (decay)</p>
                                    
                                    <h3>Solution</h3>
                                    <p>\\(P(t) = P_0 e^{kt}\\)</p>
                                    
                                    <h3>Applications</h3>
                                    <ul>
                                        <li>Population growth</li>
                                        <li>Radioactive decay</li>
                                        <li>Compound interest</li>
                                        <li>Drug concentration in bloodstream</li>
                                    </ul>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Carbon-14 dating</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Half-life of C-14 is 5730 years</p>
                                            <p>\\(\\frac{1}{2}P_0 = P_0 e^{5730k}\\)</p>
                                            <p>\\(k = \\frac{\\ln(0.5)}{5730} ≈ -1.21 × 10^{-4}\\)</p>
                                            <p>Model: \\(P(t) = P_0 e^{-1.21 × 10^{-4}t}\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u8l6': {
                                id: 'u8l6',
                                title: 'Logistic Growth Model',
                                content: `
                                    <h2>Logistic Growth Model</h2>
                                    <p class="lead">Model population growth with carrying capacity.</p>
                                    
                                    <h3>The Equation</h3>
                                    <p>\\(\\frac{dP}{dt} = kP(M - P)\\) where M is carrying capacity</p>
                                    
                                    <h3>Solution</h3>
                                    <p>\\(P(t) = \\frac{M}{1 + Ae^{-kMt}}\\) where \\(A = \\frac{M - P_0}{P_0}\\)</p>
                                    
                                    <h3>Behavior</h3>
                                    <ul>
                                        <li>Starts with exponential growth</li>
                                        <li>Growth slows as P approaches M</li>
                                        <li>Approaches carrying capacity M</li>
                                        <li>S-shaped (sigmoid) curve</li>
                                    </ul>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Population with carrying capacity 1000</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>\\(\\frac{dP}{dt} = 0.02P(1000 - P)\\)</p>
                                            <p>Initial population P₀ = 50</p>
                                            <p>\\(A = \\frac{1000 - 50}{50} = 19\\)</p>
                                            <p>\\(P(t) = \\frac{1000}{1 + 19e^{-20t}}\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u8l7': {
                                id: 'u8l7',
                                title: 'Newton\'s Law of Cooling',
                                content: `
                                    <h2>Newton's Law of Cooling</h2>
                                    <p class="lead">Model temperature changes over time.</p>
                                    
                                    <h3>The Law</h3>
                                    <p>\\(\\frac{dT}{dt} = -k(T - T_s)\\)</p>
                                    <p>where T is object temperature, Tₛ is surrounding temperature</p>
                                    
                                    <h3>Solution</h3>
                                    <p>\\(T(t) = T_s + (T_0 - T_s)e^{-kt}\\)</p>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Example: Coffee cooling</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <p>Coffee at 95°C in 20°C room</p>
                                            <p>After 5 min, temperature is 85°C</p>
                                            <p>Find k: \\(85 = 20 + (95-20)e^{-5k}\\)</p>
                                            <p>\\(65 = 75e^{-5k}\\) ⟹ \\(k ≈ 0.0287\\)</p>
                                            <p>Model: \\(T(t) = 20 + 75e^{-0.0287t}\\)</p>
                                        </div>
                                    </div>
                                `
                            },
                            'u8l8': {
                                id: 'u8l8',
                                title: 'Differential Equations Review',
                                content: `
                                    <h2>Differential Equations Review</h2>
                                    <p class="lead">Master the fundamentals of differential equations.</p>
                                    
                                    <h3>Key Concepts</h3>
                                    <ul>
                                        <li>Slope fields visualize solutions</li>
                                        <li>Euler's method gives numerical approximations</li>
                                        <li>Separable equations: separate and integrate</li>
                                        <li>Exponential model: \\(\\frac{dy}{dt} = ky\\)</li>
                                        <li>Logistic model: \\(\\frac{dy}{dt} = ky(M-y)\\)</li>
                                        <li>Newton's cooling: \\(\\frac{dT}{dt} = -k(T-T_s)\\)</li>
                                    </ul>
                                    
                                    <div class="toggle-section">
                                        <div class="toggle-header">
                                            <span>Problem-Solving Strategy</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="toggle-content">
                                            <ol>
                                                <li><strong>Identify the type:</strong> Separable? Exponential? Logistic?</li>
                                                <li><strong>Set up the equation:</strong> What's the rate of change?</li>
                                                <li><strong>Solve:</strong> Use appropriate method</li>
                                                <li><strong>Apply conditions:</strong> Use initial conditions to find constants</li>
                                                <li><strong>Interpret:</strong> What does the solution mean in context?</li>
                                            </ol>
                                        </div>
                                    </div>
                                `
                            }
                        },
                        quiz: {
                            questions: [
                                {
                                    type: 'multiple-choice',
                                    question: 'What is the general solution to \\(\\frac{dy}{dx} = 3x^2\\)?',
                                    options: ['\\(y = 3x^2 + C\\)', '\\(y = x^3 + C\\)', '\\(y = 6x + C\\)', '\\(y = 9x + C\\)'],
                                    correct: 1,
                                    feedback: 'Integrating both sides: \\(y = \\int 3x^2 \\, dx = x^3 + C\\)'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'The differential equation \\(\\frac{dy}{dx} = ky\\) models:',
                                    options: ['Linear growth', 'Exponential growth/decay', 'Logistic growth', 'Cooling'],
                                    correct: 1,
                                    feedback: 'This is the standard exponential growth/decay model.'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'Which equation represents logistic growth?',
                                    options: [
                                        '\\(\\frac{dP}{dt} = kP\\)',
                                        '\\(\\frac{dP}{dt} = k(M - P)\\)',
                                        '\\(\\frac{dP}{dt} = kP(M - P)\\)',
                                        '\\(\\frac{dP}{dt} = -k(P - M)\\)'
                                    ],
                                    correct: 2,
                                    feedback: 'Logistic growth: \\(\\frac{dP}{dt} = kP(M - P)\\) where M is carrying capacity.'
                                },
                                {
                                    type: 'multiple-choice',
                                    question: 'For separable DE \\(\\frac{dy}{dx} = xy\\), the first step is:',
                                    options: [
                                        'Integrate both sides',
                                        'Write as \\(\\frac{dy}{y} = x \\, dx\\)',
                                        'Multiply by dx',
                                        'Take the derivative'
                                    ],
                                    correct: 1,
                                    feedback: 'Separate variables: move y terms to left, x terms to right.'
                                },
                                {
                                    type: 'numeric',
                                    question: 'Using Euler\'s method with h = 0.1, find y₁ for \\(\\frac{dy}{dx} = 2x\\), y(0) = 1',
                                    answer: 1,
                                    tolerance: 0.01,
                                    feedback: 'y₁ = y₀ + h·f(x₀,y₀) = 1 + 0.1·2(0) = 1'
                                }
                            ]
                        }
                    }
                }
            }
        };
        
        // Progress management
        function getProgress() {
            const stored = localStorage.getItem('ml-progress');
            if (stored) {
                return JSON.parse(stored);
            }
            return { courseId: 'calc1', units: {} };
        }
        
        function saveProgress(progress) {
            localStorage.setItem('ml-progress', JSON.stringify(progress));
            updateStats();
        }
        
        function markCompleted(lessonId) {
            const progress = getProgress();
            const unitId = parseInt(lessonId.charAt(1));
            if (!progress.units[unitId]) {
                progress.units[unitId] = { completed: {}, quizScore: null };
            }
            progress.units[unitId].completed[lessonId] = true;
            saveProgress(progress);
            renderLessonList();
            updateUnitProgress();
        }
        
        function resetProgress() {
            if (confirm('Are you sure you want to reset all progress? This cannot be undone.')) {
                localStorage.removeItem('ml-progress');
                location.reload();
            }
        }
        
        // Statistics
        function updateStats() {
            const progress = getProgress();
            let totalLessons = 0;
            let completedLessons = 0;
            
            Object.values(courseData.calc1.units).forEach(unit => {
                totalLessons += Object.keys(unit.lessons).length;
                if (progress.units[unit.id] && progress.units[unit.id].completed) {
                    completedLessons += Object.keys(progress.units[unit.id].completed).length;
                }
            });
            
            const progressPercent = totalLessons > 0 ? Math.round((completedLessons / totalLessons) * 100) : 0;
            
            document.getElementById('totalLessons').textContent = totalLessons;
            document.getElementById('completedLessons').textContent = completedLessons;
            document.getElementById('progressPercent').textContent = progressPercent + '%';
            document.getElementById('calc1Progress').style.width = progressPercent + '%';
        }
        
        // Navigation
        function showPage(pageId) {
            document.querySelectorAll('[id$="Page"]').forEach(page => {
                page.classList.add('hidden');
            });
            document.getElementById(pageId).classList.remove('hidden');
        }
        
        function showOverview() {
            showPage('overviewPage');
            updateStats();
        }
        
        function openCourse(courseId) {
            showPage('coursePage');
            renderUnitsGrid();
        }
        
        function openUnit(unitId) {
            currentUnit = unitId;
            showPage('unitPage');
            renderUnit(unitId);
        }
        
        function setActiveLesson(lessonId) {
            currentLesson = lessonId;
            renderLesson(lessonId);
            markCompleted(lessonId);
        }
        
        // Rendering functions
        function renderUnitsGrid() {
            const grid = document.getElementById('unitsGrid');
            grid.innerHTML = '';
            
            Object.values(courseData.calc1.units).forEach(unit => {
                const progress = getProgress();
                const unitProgress = progress.units[unit.id];
                const completed = unitProgress ? Object.keys(unitProgress.completed).length : 0;
                const total = Object.keys(unit.lessons).length;
                const progressPercent = total > 0 ? Math.round((completed / total) * 100) : 0;
                
                const card = document.createElement('div');
                card.className = 'card';
                card.onclick = () => openUnit(unit.id);
                card.tabIndex = 0;
                card.setAttribute('role', 'button');
                card.setAttribute('aria-label', `Open Unit ${unit.id} - ${unit.title}`);
                
                card.innerHTML = `
                    <div class="card-header">
                        <div style="display: flex; align-items: center;">
                            <span class="unit-number">${unit.id}</span>
                            <div>
                                <h3 class="card-title">Unit ${unit.id}</h3>
                                <p>${unit.title}</p>
                            </div>
                        </div>
                    </div>
                    <div class="card-content">
                        <ul class="topic-list">
                            ${unit.topics.map(topic => `
                                <li class="topic-item">
                                    <i class="fas fa-circle" style="font-size: 0.25rem; color: hsl(var(--muted-foreground));"></i>
                                    ${topic}
                                </li>
                            `).join('')}
                        </ul>
                        <div class="progress-bar" style="margin-top: 1rem;">
                            <div class="progress-fill" style="width: ${progressPercent}%"></div>
                        </div>
                        <p style="margin-top: 0.5rem; font-size: 0.875rem; color: hsl(var(--muted-foreground));">
                            ${completed}/${total} lessons • ${progressPercent}% complete
                        </p>
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }
        
        let currentUnit = 1;
        let currentLesson = 'u1l1';
        
        function renderUnit(unitId) {
            const unit = courseData.calc1.units[unitId];
            document.getElementById('unitBreadcrumb').textContent = `Unit ${unitId}`;
            document.getElementById('unitTitle').textContent = `Unit ${unitId} - ${unit.title}`;
            
            renderLessonList();
            updateUnitProgress();
            setActiveLesson(Object.keys(unit.lessons)[0]);
        }
        
        function renderLessonList() {
            const unit = courseData.calc1.units[currentUnit];
            const lessonList = document.getElementById('lessonList');
            const progress = getProgress();
            const unitProgress = progress.units[currentUnit];
            
            lessonList.innerHTML = '';
            
            Object.entries(unit.lessons).forEach(([lessonId, lesson]) => {
                const li = document.createElement('li');
                li.className = 'lesson-item';
                li.onclick = () => setActiveLesson(lessonId);
                li.tabIndex = 0;
                li.setAttribute('role', 'button');
                
                if (lessonId === currentLesson) {
                    li.classList.add('active');
                }
                
                if (unitProgress && unitProgress.completed[lessonId]) {
                    li.classList.add('completed');
                }
                
                li.innerHTML = `
                    <i class="fas ${unitProgress && unitProgress.completed[lessonId] ? 'fa-check-circle' : 'fa-circle'}" style="color: ${unitProgress && unitProgress.completed[lessonId] ? 'hsl(var(--success))' : 'hsl(var(--muted-foreground))'}; font-size: 0.75rem;"></i>
                    ${lesson.title}
                `;
                
                lessonList.appendChild(li);
            });
            
            // Add quiz item
            const quizLi = document.createElement('li');
            quizLi.className = 'lesson-item';
            quizLi.onclick = () => showQuiz();
            quizLi.tabIndex = 0;
            quizLi.setAttribute('role', 'button');
            
            if (unitProgress && unitProgress.quizScore !== null) {
                quizLi.classList.add('completed');
            }
            
            quizLi.innerHTML = `
                <i class="fas ${unitProgress && unitProgress.quizScore !== null ? 'fa-check-circle' : 'fa-circle'}" style="color: ${unitProgress && unitProgress.quizScore !== null ? 'hsl(var(--success))' : 'hsl(var(--muted-foreground))'}; font-size: 0.75rem;"></i>
                Unit ${currentUnit} Quiz
                ${unitProgress && unitProgress.quizScore !== null ? `<span style="margin-left: auto; font-size: 0.75rem;">${Math.round(unitProgress.quizScore)}%</span>` : ''}
            `;
            
            lessonList.appendChild(quizLi);
        }
        
        function updateUnitProgress() {
            const unit = courseData.calc1.units[currentUnit];
            const progress = getProgress();
            const unitProgress = progress.units[currentUnit];
            const completed = unitProgress ? Object.keys(unitProgress.completed).length : 0;
            const total = Object.keys(unit.lessons).length;
            const progressPercent = total > 0 ? Math.round((completed / total) * 100) : 0;
            
            document.getElementById('unitProgress').style.width = progressPercent + '%';
        }
        
        function renderLesson(lessonId) {
            const unit = courseData.calc1.units[currentUnit];
            const lesson = unit.lessons[lessonId];
            const contentArea = document.getElementById('contentArea');
            
            contentArea.innerHTML = `
                <div id="lessonContent">
                    ${lesson.content}
                    <div class="navigation">
                        <button class="btn btn-outline" onclick="navigateLesson('prev')" id="prevBtn">
                            <i class="fas fa-chevron-left"></i> Previous
                        </button>
                        <button class="btn btn-primary" onclick="navigateLesson('next')" id="nextBtn">
                            Next <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            `;
            
            updateNavigationButtons();
            
            // Re-typeset MathJax
            if (window.MathJax) {
                MathJax.typesetPromise([contentArea]).catch((err) => console.log(err.message));
            }
        }
        
        function updateNavigationButtons() {
            const unit = courseData.calc1.units[currentUnit];
            const lessonIds = Object.keys(unit.lessons);
            const currentIndex = lessonIds.indexOf(currentLesson);
            
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            if (prevBtn) prevBtn.style.display = currentIndex > 0 ? 'inline-flex' : 'none';
            if (nextBtn) {
                if (currentIndex < lessonIds.length - 1) {
                    nextBtn.textContent = 'Next';
                    nextBtn.innerHTML = 'Next <i class="fas fa-chevron-right"></i>';
                } else {
                    nextBtn.textContent = 'Take Quiz';
                    nextBtn.innerHTML = 'Take Quiz <i class="fas fa-quiz"></i>';
                    nextBtn.onclick = () => showQuiz();
                }
            }
        }
        
        function navigateLesson(direction) {
            const unit = courseData.calc1.units[currentUnit];
            const lessonIds = Object.keys(unit.lessons);
            const currentIndex = lessonIds.indexOf(currentLesson);
            
            if (direction === 'prev' && currentIndex > 0) {
                setActiveLesson(lessonIds[currentIndex - 1]);
            } else if (direction === 'next' && currentIndex < lessonIds.length - 1) {
                setActiveLesson(lessonIds[currentIndex + 1]);
            } else if (direction === 'next' && currentIndex === lessonIds.length - 1) {
                showQuiz();
            }
        }
        
        // Quiz functionality
        let quizAnswers = {};
        let quizSubmitted = false;
        
        function showQuiz() {
            const unit = courseData.calc1.units[currentUnit];
            const quiz = unit.quiz;
            const progress = getProgress();
            const unitProgress = progress.units[currentUnit];
            
            quizAnswers = {};
            quizSubmitted = false;
            
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = `
                <div id="quizContent">
                    <h2>Unit ${currentUnit} Quiz</h2>
                    <p class="lead">Test your understanding of ${unit.title}</p>
                    
                    ${unitProgress && unitProgress.quizScore !== null ? 
                        `<div class="quiz-feedback ${unitProgress.quizScore >= 70 ? 'correct' : 'incorrect'}">
                            Previous Score: ${Math.round(unitProgress.quizScore)}% ${unitProgress.quizScore >= 70 ? '(Passed)' : '(Failed - 70% needed to pass)'}
                        </div>` : ''
                    }
                    
                    <div id="quizQuestions">
                        ${quiz.questions.map((q, i) => renderQuizQuestion(q, i)).join('')}
                    </div>
                    
                    <div style="margin-top: 2rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="submitQuiz()" id="submitBtn">
                            Submit Quiz
                        </button>
                        <button class="btn btn-outline" onclick="revealAllSolutions()" id="revealBtn" style="display: none;">
                            Reveal All Solutions
                        </button>
                        <button class="btn btn-secondary" onclick="resetQuiz()">
                            Reset Quiz
                        </button>
                    </div>
                </div>
            `;
            
            // Re-typeset MathJax
            if (window.MathJax) {
                MathJax.typesetPromise([contentArea]).catch((err) => console.log(err.message));
            }
        }
        
        function renderQuizQuestion(question, index) {
            if (question.type === 'multiple-choice') {
                return `
                    <div class="quiz-question" id="question-${index}">
                        <h4>Question ${index + 1}</h4>
                        <p>${question.question}</p>
                        <ul class="quiz-options">
                            ${question.options.map((option, optIndex) => `
                                <li class="quiz-option" onclick="selectOption(${index}, ${optIndex})" 
                                    data-question="${index}" data-option="${optIndex}">
                                    ${String.fromCharCode(65 + optIndex)}. ${option}
                                </li>
                            `).join('')}
                        </ul>
                        <div class="quiz-feedback" id="feedback-${index}" style="display: none;"></div>
                    </div>
                `;
            } else if (question.type === 'numeric') {
                return `
                    <div class="quiz-question" id="question-${index}">
                        <h4>Question ${index + 1}</h4>
                        <p>${question.question}</p>
                        <input type="text" class="quiz-input" id="input-${index}" 
                               placeholder="Enter your answer" onchange="updateNumericAnswer(${index}, this.value)">
                        <div class="quiz-feedback" id="feedback-${index}" style="display: none;"></div>
                    </div>
                `;
            } else if (question.type === 'short-text') {
                return `
                    <div class="quiz-question" id="question-${index}">
                        <h4>Question ${index + 1}</h4>
                        <p>${question.question}</p>
                        <input type="text" class="quiz-input" id="input-${index}" 
                               placeholder="Enter your answer" onchange="updateTextAnswer(${index}, this.value)">
                        <div class="quiz-feedback" id="feedback-${index}" style="display: none;"></div>
                    </div>
                `;
            }
        }
        
        function selectOption(questionIndex, optionIndex) {
            if (quizSubmitted) return;
            
            // Clear previous selections
            const questionEl = document.getElementById(`question-${questionIndex}`);
            questionEl.querySelectorAll('.quiz-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Select new option
            const selectedOption = questionEl.querySelector(`[data-option="${optionIndex}"]`);
            selectedOption.classList.add('selected');
            
            quizAnswers[questionIndex] = optionIndex;
        }
        
        function updateNumericAnswer(questionIndex, value) {
            quizAnswers[questionIndex] = value;
        }
        
        function updateTextAnswer(questionIndex, value) {
            quizAnswers[questionIndex] = value;
        }
        
        function submitQuiz() {
            const unit = courseData.calc1.units[currentUnit];
            const quiz = unit.quiz;
            let correct = 0;
            
            quiz.questions.forEach((question, index) => {
                const isCorrect = checkAnswer(question, index, quizAnswers[index]);
                if (isCorrect) correct++;
                showQuestionFeedback(question, index, isCorrect);
            });
            
            const score = (correct / quiz.questions.length) * 100;
            
            // Save score
            const progress = getProgress();
            if (!progress.units[currentUnit]) {
                progress.units[currentUnit] = { completed: {}, quizScore: null };
            }
            progress.units[currentUnit].quizScore = score;
            saveProgress(progress);
            
            // Show results
            const resultsEl = document.createElement('div');
            resultsEl.className = `quiz-feedback ${score >= 70 ? 'correct' : 'incorrect'}`;
            resultsEl.innerHTML = `
                <h3>Quiz Results</h3>
                <p><strong>Score: ${Math.round(score)}%</strong> (${correct}/${quiz.questions.length} correct)</p>
                <p>${score >= 70 ? 'Congratulations! You passed the quiz.' : 'You need 70% to pass. Review the material and try again.'}</p>
            `;
            
            document.getElementById('quizContent').insertBefore(resultsEl, document.getElementById('quizQuestions'));
            
            document.getElementById('submitBtn').style.display = 'none';
            document.getElementById('revealBtn').style.display = 'inline-flex';
            
            quizSubmitted = true;
            renderLessonList();
        }
        
        function checkAnswer(question, questionIndex, answer) {
            if (question.type === 'multiple-choice') {
                return answer === question.correct;
            } else if (question.type === 'numeric') {
                const numAnswer = parseFloat(answer);
                const correct = parseFloat(question.answer);
                const tolerance = question.tolerance || 0.01;
                return Math.abs(numAnswer - correct) <= tolerance;
            } else if (question.type === 'short-text') {
                const normalizedAnswer = answer.toLowerCase().trim();
                const acceptedAnswers = Array.isArray(question.answer) ? 
                    question.answer.map(a => a.toLowerCase().trim()) : 
                    [question.answer.toLowerCase().trim()];
                return acceptedAnswers.includes(normalizedAnswer);
            }
            return false;
        }
        
        function showQuestionFeedback(question, questionIndex, isCorrect) {
            const feedbackEl = document.getElementById(`feedback-${questionIndex}`);
            feedbackEl.style.display = 'block';
            feedbackEl.className = `quiz-feedback ${isCorrect ? 'correct' : 'incorrect'}`;
            feedbackEl.innerHTML = `
                <strong>${isCorrect ? 'Correct!' : 'Incorrect'}</strong><br>
                ${question.feedback}
            `;
            
            // Highlight correct/incorrect options for multiple choice
            if (question.type === 'multiple-choice') {
                const questionEl = document.getElementById(`question-${questionIndex}`);
                const options = questionEl.querySelectorAll('.quiz-option');
                options.forEach((opt, i) => {
                    if (i === question.correct) {
                        opt.classList.add('correct');
                    } else if (opt.classList.contains('selected')) {
                        opt.classList.add('incorrect');
                    }
                });
            }
        }
        
        function revealAllSolutions() {
            const unit = courseData.calc1.units[currentUnit];
            const quiz = unit.quiz;
            
            quiz.questions.forEach((question, index) => {
                showQuestionFeedback(question, index, checkAnswer(question, index, quizAnswers[index]));
            });
        }
        
        function resetQuiz() {
            if (confirm('Reset quiz? This will clear all your answers.')) {
                showQuiz();
            }
        }
        
        // Toggle functionality
        function toggleContent(header) {
            const content = header.nextElementSibling;
            const icon = header.querySelector('i');
            
            if (content.classList.contains('open')) {
                content.classList.remove('open');
                icon.className = 'fas fa-chevron-down';
            } else {
                content.classList.add('open');
                icon.className = 'fas fa-chevron-up';
                
                // Re-typeset MathJax for the revealed content
                if (window.MathJax) {
                    MathJax.typesetPromise([content]).catch((err) => console.log(err.message));
                }
            }
        }
        
        // Keyboard accessibility
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                if (document.activeElement.classList.contains('lesson-item')) {
                    e.preventDefault();
                    document.activeElement.click();
                }
                if (document.activeElement.classList.contains('card')) {
                    e.preventDefault();
                    document.activeElement.click();
                }
                if (document.activeElement.classList.contains('toggle-header')) {
                    e.preventDefault();
                    document.activeElement.click();
                }
            }
        });
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            showOverview();
        });
        
        // Make functions globally available
        window.showOverview = showOverview;
        window.openCourse = openCourse;
        window.openUnit = openUnit;
        window.setActiveLesson = setActiveLesson;
        window.toggleContent = toggleContent;
        window.navigateLesson = navigateLesson;
        window.showQuiz = showQuiz;
        window.submitQuiz = submitQuiz;
        window.resetQuiz = resetQuiz;
        window.revealAllSolutions = revealAllSolutions;
        window.selectOption = selectOption;
        window.updateNumericAnswer = updateNumericAnswer;
        window.updateTextAnswer = updateTextAnswer;
        window.resetProgress = resetProgress;
    </script>
</body>
</html>
